import{S as ze,i as Se,f as De,b as A,d as V,m as R,t as w,a as v,e as z,g as he,c as pe}from"../chunks/index.a2391391.js";import{s as ye,g as Ie,a as Ee,c as Fe,b as k,d as _,e as b,h as Ze,i as O,f as m,n as Me,j as Je,k as Qe,t as se,l as ae,m as oe,w as Ae,A as Ve,C as $,x as D,D as I,X as xt,z as M,J as qe,a1 as $t,N as Ke,Q as ft,G as en,p as me,B as tn,S as nn,T as rn,o as Re,E as fe}from"../chunks/scheduler.ee52cacd.js";import{e as Ge}from"../chunks/each.4f9c2159.js";import{p as ln}from"../chunks/stores.5de49fb7.js";import{g as ct}from"../chunks/spread.5cc747ed.js";import{P as sn}from"../chunks/index.691cdcca.js";import{P as xe,V as ut}from"../chunks/index.550ce75a.js";import{C as an,P as on}from"../chunks/index.fc85f1f4.js";import{g as fn}from"../chunks/store.f203a796.js";import{p as Yt}from"../chunks/user.9ccdc884.js";import{R as st}from"../chunks/index.f39bbea9.js";import{w as Gt}from"../chunks/index.45ef5fca.js";import{C as un}from"../chunks/index.5d9eba69.js";import{c as lt}from"../chunks/date.4043184d.js";import{M as Zt}from"../chunks/index.bf0b6763.js";import{H as cn}from"../chunks/HTMLRender.93b52c11.js";import{g as dn,h as mn}from"../chunks/org.1ee4885a.js";import{i as It,g as _n}from"../chunks/toHtml.5650e1c7.js";import{p as Et}from"../chunks/pluralize.2d93e111.js";import{e as gn,h as hn}from"../chunks/validator.b0d7db8b.js";import{O as Jt,a as rt}from"../chunks/OverflowMenuItem.fb1aab9d.js";import{T as pn}from"../chunks/index.846953bc.js";import{s as ke}from"../chunks/supabase.2c784bff.js";import{s as de}from"../chunks/store.21c1b842.js";import{t as Qt}from"../chunks/translations.f943b7b3.js";import{B as wn}from"../chunks/index.6649ce47.js";import{S as bn}from"../chunks/SkeletonPlaceholder.85251fa5.js";import{S as Ft}from"../chunks/SkeletonText.4f748957.js";import{g as vn}from"../chunks/navigation.4bf4851d.js";(function(){try{var l=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(l._sentryDebugIds=l._sentryDebugIds||{},l._sentryDebugIds[e]="ce0bdb8c-1bc5-43ff-9a4d-207b24af4153",l._sentryDebugIdIdentifier="sentry-dbid-ce0bdb8c-1bc5-43ff-9a4d-207b24af4153")}catch{}})();function Nt(l){let e,n;return{c(){e=Ee("title"),n=se(l[1])},l(t){e=Fe(t,"title",{});var r=k(e);n=ae(r,l[1]),r.forEach(_)},m(t,r){O(t,e,r),m(e,n)},p(t,r){r&2&&oe(n,t[1])},d(t){t&&_(e)}}}function kn(l){let e,n,t=l[1]&&Nt(l),r=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:l[0]},{height:l[0]},l[2],l[3]],a={};for(let s=0;s<r.length;s+=1)a=Ie(a,r[s]);return{c(){e=Ee("svg"),t&&t.c(),n=Ee("path"),this.h()},l(s){e=Fe(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,preserveAspectRatio:!0,width:!0,height:!0});var o=k(e);t&&t.l(o),n=Fe(o,"path",{d:!0}),k(n).forEach(_),o.forEach(_),this.h()},h(){b(n,"d","M28.5858,13.3137,30,11.9,20,2,18.6858,3.415l1.1858,1.1857L8.38,14.3225,6.6641,12.6067,5.25,14l5.6572,5.6773L2,28.5831,3.41,30l8.9111-8.9087L18,26.7482l1.3929-1.414L17.6765,23.618l9.724-11.4895Z"),Ze(e,a)},m(s,o){O(s,e,o),t&&t.m(e,null),m(e,n)},p(s,[o]){s[1]?t?t.p(s,o):(t=Nt(s),t.c(),t.m(e,n)):t&&(t.d(1),t=null),Ze(e,a=ct(r,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},o&1&&{width:s[0]},o&1&&{height:s[0]},o&4&&s[2],o&8&&s[3]]))},i:Me,o:Me,d(s){s&&_(e),t&&t.d()}}}function $n(l,e,n){let t,r;const a=["size","title"];let s=Je(e,a),{size:o=16}=e,{title:i=void 0}=e;return l.$$set=u=>{n(5,e=Ie(Ie({},e),Qe(u))),n(3,s=Je(e,a)),"size"in u&&n(0,o=u.size),"title"in u&&n(1,i=u.title)},l.$$.update=()=>{n(4,t=e["aria-label"]||e["aria-labelledby"]||i),n(2,r={"aria-hidden":t?void 0:!0,role:t?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=Qe(e),[o,i,r,s,t]}class In extends ze{constructor(e){super(),Se(this,e,$n,kn,ye,{size:0,title:1})}}function Ct(l){let e,n;return{c(){e=Ee("title"),n=se(l[1])},l(t){e=Fe(t,"title",{});var r=k(e);n=ae(r,l[1]),r.forEach(_)},m(t,r){O(t,e,r),m(e,n)},p(t,r){r&2&&oe(n,t[1])},d(t){t&&_(e)}}}function En(l){let e,n,t=l[1]&&Ct(l),r=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:l[0]},{height:l[0]},l[2],l[3]],a={};for(let s=0;s<r.length;s+=1)a=Ie(a,r[s]);return{c(){e=Ee("svg"),t&&t.c(),n=Ee("path"),this.h()},l(s){e=Fe(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,preserveAspectRatio:!0,width:!0,height:!0});var o=k(e);t&&t.l(o),n=Fe(o,"path",{d:!0}),k(n).forEach(_),o.forEach(_),this.h()},h(){b(n,"d","M27.45,15.11l-22-11a1,1,0,0,0-1.08.12,1,1,0,0,0-.33,1L7,16,4,26.74A1,1,0,0,0,5,28a1,1,0,0,0,.45-.11l22-11a1,1,0,0,0,0-1.78Zm-20.9,10L8.76,17H18V15H8.76L6.55,6.89,24.76,16Z"),Ze(e,a)},m(s,o){O(s,e,o),t&&t.m(e,null),m(e,n)},p(s,[o]){s[1]?t?t.p(s,o):(t=Ct(s),t.c(),t.m(e,n)):t&&(t.d(1),t=null),Ze(e,a=ct(r,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},o&1&&{width:s[0]},o&1&&{height:s[0]},o&4&&s[2],o&8&&s[3]]))},i:Me,o:Me,d(s){s&&_(e),t&&t.d()}}}function Fn(l,e,n){let t,r;const a=["size","title"];let s=Je(e,a),{size:o=16}=e,{title:i=void 0}=e;return l.$$set=u=>{n(5,e=Ie(Ie({},e),Qe(u))),n(3,s=Je(e,a)),"size"in u&&n(0,o=u.size),"title"in u&&n(1,i=u.title)},l.$$.update=()=>{n(4,t=e["aria-label"]||e["aria-labelledby"]||i),n(2,r={"aria-hidden":t?void 0:!0,role:t?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=Qe(e),[o,i,r,s,t]}class Nn extends ze{constructor(e){super(),Se(this,e,Fn,En,ye,{size:0,title:1})}}function Pt(l){let e,n;return{c(){e=Ee("title"),n=se(l[1])},l(t){e=Fe(t,"title",{});var r=k(e);n=ae(r,l[1]),r.forEach(_)},m(t,r){O(t,e,r),m(e,n)},p(t,r){r&2&&oe(n,t[1])},d(t){t&&_(e)}}}function Cn(l){let e,n,t=l[1]&&Pt(l),r=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:l[0]},{height:l[0]},l[2],l[3]],a={};for(let s=0;s<r.length;s+=1)a=Ie(a,r[s]);return{c(){e=Ee("svg"),t&&t.c(),n=Ee("path"),this.h()},l(s){e=Fe(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,preserveAspectRatio:!0,width:!0,height:!0});var o=k(e);t&&t.l(o),n=Fe(o,"path",{d:!0}),k(n).forEach(_),o.forEach(_),this.h()},h(){b(n,"d","M30 30H28V25a5.0057 5.0057 0 00-5-5V18a7.0078 7.0078 0 017 7zM22 30H20V25a5.0059 5.0059 0 00-5-5H9a5.0059 5.0059 0 00-5 5v5H2V25a7.0082 7.0082 0 017-7h6a7.0082 7.0082 0 017 7zM20 2V4a5 5 0 010 10v2A7 7 0 0020 2zM12 4A5 5 0 117 9a5 5 0 015-5m0-2a7 7 0 107 7A7 7 0 0012 2z"),Ze(e,a)},m(s,o){O(s,e,o),t&&t.m(e,null),m(e,n)},p(s,[o]){s[1]?t?t.p(s,o):(t=Pt(s),t.c(),t.m(e,n)):t&&(t.d(1),t=null),Ze(e,a=ct(r,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},o&1&&{width:s[0]},o&1&&{height:s[0]},o&4&&s[2],o&8&&s[3]]))},i:Me,o:Me,d(s){s&&_(e),t&&t.d()}}}function Pn(l,e,n){let t,r;const a=["size","title"];let s=Je(e,a),{size:o=16}=e,{title:i=void 0}=e;return l.$$set=u=>{n(5,e=Ie(Ie({},e),Qe(u))),n(3,s=Je(e,a)),"size"in u&&n(0,o=u.size),"title"in u&&n(1,i=u.title)},l.$$.update=()=>{n(4,t=e["aria-label"]||e["aria-labelledby"]||i),n(2,r={"aria-hidden":t?void 0:!0,role:t?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=Qe(e),[o,i,r,s,t]}class Dn extends ze{constructor(e){super(),Se(this,e,Pn,Cn,ye,{size:0,title:1})}}const Mn=({params:l={id:""}})=>({courseId:l.id}),jr=Object.freeze(Object.defineProperty({__proto__:null,load:Mn},Symbol.toStringTag,{value:"Module"})),Pe=Gt({open:!1}),ve=Gt([]);function An(l){let e,n,t="Are you sure you want to delete this feed?",r,a,s,o,i,u;return s=new xe({props:{className:"px-6 py-3",variant:ut.OUTLINED,label:"No",onClick:l[3]}}),i=new xe({props:{className:"px-6 py-3",variant:ut.OUTLINED,label:"Yes",onClick:l[1]}}),{c(){e=$("div"),n=$("h1"),n.textContent=t,r=D(),a=$("div"),A(s.$$.fragment),o=D(),A(i.$$.fragment),this.h()},l(f){e=I(f,"DIV",{});var c=k(e);n=I(c,"H1",{class:!0,"data-svelte-h":!0}),xt(n)!=="svelte-z8g13n"&&(n.textContent=t),r=M(c),a=I(c,"DIV",{class:!0});var g=k(a);V(s.$$.fragment,g),o=M(g),V(i.$$.fragment,g),g.forEach(_),c.forEach(_),this.h()},h(){b(n,"class","dark:text-white text-lg"),b(a,"class","mt-5 flex items-center justify-between")},m(f,c){O(f,e,c),m(e,n),m(e,r),m(e,a),R(s,a,null),m(a,o),R(i,a,null),u=!0},p(f,c){const g={};c&1&&(g.onClick=f[3]),s.$set(g)},i(f){u||(w(s.$$.fragment,f),w(i.$$.fragment,f),u=!0)},o(f){v(s.$$.fragment,f),v(i.$$.fragment,f),u=!1},d(f){f&&_(e),z(s),z(i)}}}function Vn(l){let e,n,t;function r(s){l[5](s)}let a={onClose:l[4],width:"w-96",modalHeading:"Delete Feed",$$slots:{default:[An]},$$scope:{ctx:l}};return l[0]!==void 0&&(a.open=l[0]),e=new Zt({props:a}),Ae.push(()=>De(e,"open",r)),{c(){A(e.$$.fragment)},l(s){V(e.$$.fragment,s)},m(s,o){R(e,s,o),t=!0},p(s,[o]){const i={};o&1&&(i.onClose=s[4]),o&65&&(i.$$scope={dirty:o,ctx:s}),!n&&o&1&&(n=!0,i.open=s[0],Ve(()=>n=!1)),e.$set(i)},i(s){t||(w(e.$$.fragment,s),t=!0)},o(s){v(e.$$.fragment,s),t=!1},d(s){z(e,s)}}}function Rn(l,e,n){let{openDeleteModal:t=!1}=e,{deleteFeed:r=()=>{}}=e;async function a(){r(),n(0,t=!1)}const s=()=>n(0,t=!1),o=()=>n(0,t=!1);function i(u){t=u,n(0,t)}return l.$$set=u=>{"openDeleteModal"in u&&n(0,t=u.openDeleteModal),"deleteFeed"in u&&n(2,r=u.deleteFeed)},[t,a,r,s,o,i]}class zn extends ze{constructor(e){super(),Se(this,e,Rn,Vn,ye,{openDeleteModal:0,deleteFeed:2})}}function Dt(l,e,n){const t=l.slice();return t[9]=e[n],t[32]=n,t}function Mt(l,e,n){const t=l.slice();return t[33]=e[n],t}function Sn(l){let e,n,t,r,a,s;return e=new rt({props:{text:l[0].isPinned?"Unpin":"Pin"}}),e.$on("click",l[24]),t=new rt({props:{text:"Edit"}}),t.$on("click",l[11]),a=new rt({props:{danger:!0,text:"Delete"}}),a.$on("click",l[25]),{c(){A(e.$$.fragment),n=D(),A(t.$$.fragment),r=D(),A(a.$$.fragment)},l(o){V(e.$$.fragment,o),n=M(o),V(t.$$.fragment,o),r=M(o),V(a.$$.fragment,o)},m(o,i){R(e,o,i),O(o,n,i),R(t,o,i),O(o,r,i),R(a,o,i),s=!0},p(o,i){const u={};i[0]&1&&(u.text=o[0].isPinned?"Unpin":"Pin"),e.$set(u)},i(o){s||(w(e.$$.fragment,o),w(t.$$.fragment,o),w(a.$$.fragment,o),s=!0)},o(o){v(e.$$.fragment,o),v(t.$$.fragment,o),v(a.$$.fragment,o),s=!1},d(o){o&&(_(n),_(r)),z(e,o),z(t,o),z(a,o)}}}function yn(l){let e,n;return e=new Jt({props:{flipped:!0,$$slots:{default:[Sn]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,r){R(e,t,r),n=!0},p(t,r){const a={};r[0]&37|r[1]&32&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function At(l){let e,n;return e=new cn({props:{className:"text-sm font-medium w-[80%] mb-4",$$slots:{content:[Tn]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,r){R(e,t,r),n=!0},p(t,r){const a={};r[0]&1|r[1]&32&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function Tn(l){let e,n,t=l[0].content+"";return{c(){e=$("div"),n=new nn(!1),this.h()},l(r){e=I(r,"DIV",{});var a=k(e);n=rn(a,!1),a.forEach(_),this.h()},h(){n.a=null},m(r,a){O(r,e,a),n.m(t,e)},p(r,a){a[0]&1&&t!==(t=r[0].content+"")&&n.p(t)},d(r){r&&_(e)}}}function Vt(l){let e,n,t=l[10][l[33]]+"",r,a,s,o,i,u,f,c=l[0].reaction[l[33]].length>=1&&Rt(l);function g(){return l[26](l[33])}return{c(){e=$("button"),n=$("div"),r=se(t),a=D(),c&&c.c(),s=D(),this.h()},l(h){e=I(h,"BUTTON",{class:!0});var F=k(e);n=I(F,"DIV",{class:!0});var S=k(n);r=ae(S,t),S.forEach(_),a=M(F),c&&c.l(F),s=M(F),F.forEach(_),this.h()},h(){b(n,"class","text-[15px]"),b(e,"class",o=`flex items-center transition ${l[0].reaction[l[33]].length>=1&&`${l[17](l[33])} dark:text-black border rounded-full`}`)},m(h,F){O(h,e,F),m(e,n),m(n,r),m(e,a),c&&c.m(e,null),m(e,s),i=!0,u||(f=Ke(e,"click",g),u=!0)},p(h,F){l=h,(!i||F[0]&1)&&t!==(t=l[10][l[33]]+"")&&oe(r,t),l[0].reaction[l[33]].length>=1?c?(c.p(l,F),F[0]&1&&w(c,1)):(c=Rt(l),c.c(),w(c,1),c.m(e,s)):c&&(he(),v(c,1,1,()=>{c=null}),pe()),(!i||F[0]&1&&o!==(o=`flex items-center transition ${l[0].reaction[l[33]].length>=1&&`${l[17](l[33])} dark:text-black border rounded-full`}`))&&b(e,"class",o)},i(h){i||(w(c),i=!0)},o(h){v(c),i=!1},d(h){h&&_(e),c&&c.d(),u=!1,f()}}}function Rt(l){let e,n;return e=new un({props:{value:l[0].reaction[l[33]].length,className:"bg-transparent"}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,r){R(e,t,r),n=!0},p(t,r){const a={};r[0]&1&&(a.value=t[0].reaction[t[33]].length),e.$set(a)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function zt(l){let e,n,t=l[10][l[33]]&&Vt(l);return{c(){t&&t.c(),e=Re()},l(r){t&&t.l(r),e=Re()},m(r,a){t&&t.m(r,a),O(r,e,a),n=!0},p(r,a){r[10][r[33]]?t?(t.p(r,a),a[0]&1&&w(t,1)):(t=Vt(r),t.c(),w(t,1),t.m(e.parentNode,e)):t&&(he(),v(t,1,1,()=>{t=null}),pe())},i(r){n||(w(t),n=!0)},o(r){v(t),n=!1},d(r){r&&_(e),t&&t.d(r)}}}function St(l){let e,n,t,r,a=Et("comment",l[0].comment.length,!0)+"",s,o,i,u;return n=new Dn({props:{size:16}}),{c(){e=$("button"),A(n.$$.fragment),t=D(),r=$("p"),s=se(a),this.h()},l(f){e=I(f,"BUTTON",{class:!0});var c=k(e);V(n.$$.fragment,c),t=M(c),r=I(c,"P",{class:!0});var g=k(r);s=ae(g,a),g.forEach(_),c.forEach(_),this.h()},h(){b(r,"class","text-sm py-2"),b(e,"class","flex flex-row items-center gap-1 -mx-2 px-2 rounded-md")},m(f,c){O(f,e,c),R(n,e,null),m(e,t),m(e,r),m(r,s),o=!0,i||(u=Ke(e,"click",l[12]),i=!0)},p(f,c){(!o||c[0]&1)&&a!==(a=Et("comment",f[0].comment.length,!0)+"")&&oe(s,a)},i(f){o||(w(n.$$.fragment,f),o=!0)},o(f){v(n.$$.fragment,f),o=!1},d(f){f&&_(e),z(n),i=!1,u()}}}function yt(l){var ie,we,q,_e;let e,n,t,r,a,s,o,i,u,f=((we=(ie=l[9].author)==null?void 0:ie.profile)==null?void 0:we.fullname)+"",c,g,h,F=lt(l[9].created_at)+"",S,H,X,K=l[9].content+"",N,ue,ce,ee,T=(((_e=(q=l[9].author)==null?void 0:q.profile)==null?void 0:_e.id)===l[7].id||l[8])&&Tt(l);return{c(){e=$("div"),n=$("span"),t=$("div"),r=$("img"),s=D(),o=$("span"),i=$("div"),u=$("p"),c=se(f),g=D(),h=$("p"),S=se(F),H=D(),X=$("p"),N=se(K),ue=D(),T&&T.c(),ce=D(),this.h()},l(B){e=I(B,"DIV",{class:!0});var L=k(e);n=I(L,"SPAN",{class:!0});var Y=k(n);t=I(Y,"DIV",{class:!0});var te=k(t);r=I(te,"IMG",{src:!0,alt:!0,class:!0}),te.forEach(_),s=M(Y),o=I(Y,"SPAN",{});var Z=k(o);i=I(Z,"DIV",{class:!0});var ne=k(i);u=I(ne,"P",{class:!0});var d=k(u);c=ae(d,f),d.forEach(_),g=M(ne),h=I(ne,"P",{class:!0});var C=k(h);S=ae(C,F),C.forEach(_),ne.forEach(_),H=M(Z),X=I(Z,"P",{});var P=k(X);N=ae(P,K),P.forEach(_),Z.forEach(_),Y.forEach(_),ue=M(L),T&&T.l(L),ce=M(L),L.forEach(_),this.h()},h(){var B,L;qe(r.src,a=(L=(B=l[9].author)==null?void 0:B.profile)==null?void 0:L.avatar_url)||b(r,"src",a),b(r,"alt","users banner"),b(r,"class","w-full h-full rounded-full object-cover"),b(t,"class","w-9 h-9"),b(u,"class","text-sm font-medium capitalize"),b(h,"class","text-xs font-medium text-gray-600"),b(i,"class","flex items-center gap-2"),b(n,"class","flex items-center gap-3"),b(e,"class","group flex justify-between items-center py-2")},m(B,L){O(B,e,L),m(e,n),m(n,t),m(t,r),m(n,s),m(n,o),m(o,i),m(i,u),m(u,c),m(i,g),m(i,h),m(h,S),m(o,H),m(o,X),m(X,N),m(e,ue),T&&T.m(e,null),m(e,ce),ee=!0},p(B,L){var Y,te,Z,ne,d,C;(!ee||L[0]&1&&!qe(r.src,a=(te=(Y=B[9].author)==null?void 0:Y.profile)==null?void 0:te.avatar_url))&&b(r,"src",a),(!ee||L[0]&1)&&f!==(f=((ne=(Z=B[9].author)==null?void 0:Z.profile)==null?void 0:ne.fullname)+"")&&oe(c,f),(!ee||L[0]&1)&&F!==(F=lt(B[9].created_at)+"")&&oe(S,F),(!ee||L[0]&1)&&K!==(K=B[9].content+"")&&oe(N,K),((C=(d=B[9].author)==null?void 0:d.profile)==null?void 0:C.id)===B[7].id||B[8]?T?(T.p(B,L),L[0]&385&&w(T,1)):(T=Tt(B),T.c(),w(T,1),T.m(e,ce)):T&&(he(),v(T,1,1,()=>{T=null}),pe())},i(B){ee||(w(T),ee=!0)},o(B){v(T),ee=!1},d(B){B&&_(e),T&&T.d()}}}function Tt(l){let e,n;return e=new Jt({props:{flipped:!0,class:"hidden group-hover:flex",$$slots:{default:[Bn]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,r){R(e,t,r),n=!0},p(t,r){const a={};r[0]&1|r[1]&32&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function Bn(l){let e,n;function t(){return l[27](l[9])}return e=new rt({props:{danger:!0,text:"Delete"}}),e.$on("click",t),{c(){A(e.$$.fragment)},l(r){V(e.$$.fragment,r)},m(r,a){R(e,r,a),n=!0},p(r,a){l=r},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){v(e.$$.fragment,r),n=!1},d(r){z(e,r)}}}function Bt(l){let e,n,t=l[9].content&&(l[4]||l[32]===l[0].comment.length-1)&&yt(l);return{c(){t&&t.c(),e=Re()},l(r){t&&t.l(r),e=Re()},m(r,a){t&&t.m(r,a),O(r,e,a),n=!0},p(r,a){r[9].content&&(r[4]||r[32]===r[0].comment.length-1)?t?(t.p(r,a),a[0]&17&&w(t,1)):(t=yt(r),t.c(),w(t,1),t.m(e.parentNode,e)):t&&(he(),v(t,1,1,()=>{t=null}),pe())},i(r){n||(w(t),n=!0)},o(r){v(t),n=!1},d(r){r&&_(e),t&&t.d(r)}}}function Ot(l){var r;let e,n=((r=l[6])==null?void 0:r.newComment)+"",t;return{c(){e=$("p"),t=se(n),this.h()},l(a){e=I(a,"P",{class:!0});var s=k(e);t=ae(s,n),s.forEach(_),this.h()},h(){b(e,"class","text-sm text-red-500")},m(a,s){O(a,e,s),m(e,t)},p(a,s){var o;s[0]&64&&n!==(n=((o=a[6])==null?void 0:o.newComment)+"")&&oe(t,n)},d(a){a&&_(e)}}}function On(l){var _t,gt,ht;let e,n,t,r,a,s,o,i,u,f,c,g=((gt=(_t=l[0].author)==null?void 0:_t.profile)==null?void 0:gt.fullname)+"",h,F,S,H=lt(l[0].created_at)+"",X,K,N,ue,ce=!It(l[0].content),ee,T,ie,we,q,_e,B,L,Y,te,Z,ne,d,C,P,W,G,re,et,ge,$e,at,tt,nt,be,ot,dt;N=new st({props:{allowedRoles:[1,2],$$slots:{default:[yn]},$$scope:{ctx:l}}});let J=ce&&At(l),Te=Ge(Object.keys(l[0].reaction)),j=[];for(let p=0;p<Te.length;p+=1)j[p]=zt(Mt(l,Te,p));const Wt=p=>v(j[p],1,1,()=>{j[p]=null});let Q=l[0].comment.length>0&&St(l),Be=Ge(l[0].comment),U=[];for(let p=0;p<Be.length;p+=1)U[p]=Bt(Dt(l,Be,p));const Xt=p=>v(U[p],1,1,()=>{U[p]=null});re=new Nn({props:{size:24}});let le=((ht=l[6])==null?void 0:ht.newComment)&&Ot(l);function Kt(p){l[29](p)}let mt={deleteFeed:l[15]};return l[5]!==void 0&&(mt.openDeleteModal=l[5]),$e=new zn({props:mt}),Ae.push(()=>De($e,"openDeleteModal",Kt)),{c(){e=$("div"),n=$("section"),t=$("div"),r=$("div"),a=$("span"),s=$("div"),o=$("img"),u=D(),f=$("span"),c=$("p"),h=se(g),F=D(),S=$("p"),X=se(H),K=D(),A(N.$$.fragment),ue=D(),J&&J.c(),ee=D(),T=$("div"),ie=$("div");for(let p=0;p<j.length;p+=1)j[p].c();we=D(),q=$("section"),Q&&Q.c(),_e=D(),B=$("div");for(let p=0;p<U.length;p+=1)U[p].c();L=D(),Y=$("div"),te=$("div"),Z=$("img"),d=D(),C=$("div"),P=$("input"),W=D(),G=$("button"),A(re.$$.fragment),et=D(),le&&le.c(),ge=D(),A($e.$$.fragment),this.h()},l(p){e=I(p,"DIV",{id:!0,class:!0});var E=k(e);n=I(E,"SECTION",{});var x=k(n);t=I(x,"DIV",{class:!0});var Oe=k(t);r=I(Oe,"DIV",{class:!0});var Le=k(r);a=I(Le,"SPAN",{class:!0});var He=k(a);s=I(He,"DIV",{class:!0});var We=k(s);o=I(We,"IMG",{src:!0,alt:!0,class:!0}),We.forEach(_),u=M(He),f=I(He,"SPAN",{});var je=k(f);c=I(je,"P",{class:!0});var Xe=k(c);h=ae(Xe,g),Xe.forEach(_),F=M(je),S=I(je,"P",{class:!0});var y=k(S);X=ae(y,H),y.forEach(_),je.forEach(_),He.forEach(_),K=M(Le),V(N.$$.fragment,Le),Le.forEach(_),ue=M(Oe),J&&J.l(Oe),Oe.forEach(_),ee=M(x),T=I(x,"DIV",{class:!0});var Ne=k(T);ie=I(Ne,"DIV",{class:!0});var pt=k(ie);for(let Ue=0;Ue<j.length;Ue+=1)j[Ue].l(pt);pt.forEach(_),Ne.forEach(_),x.forEach(_),we=M(E),q=I(E,"SECTION",{class:!0});var Ce=k(q);Q&&Q.l(Ce),_e=M(Ce),B=I(Ce,"DIV",{});var wt=k(B);for(let Ue=0;Ue<U.length;Ue+=1)U[Ue].l(wt);wt.forEach(_),L=M(Ce),Y=I(Ce,"DIV",{class:!0});var Ye=k(Y);te=I(Ye,"DIV",{class:!0});var bt=k(te);Z=I(bt,"IMG",{src:!0,alt:!0,class:!0}),bt.forEach(_),d=M(Ye),C=I(Ye,"DIV",{class:!0});var vt=k(C);P=I(vt,"INPUT",{type:!0,placeholder:!0,class:!0}),vt.forEach(_),W=M(Ye),G=I(Ye,"BUTTON",{});var kt=k(G);V(re.$$.fragment,kt),kt.forEach(_),Ye.forEach(_),et=M(Ce),le&&le.l(Ce),Ce.forEach(_),ge=M(E),V($e.$$.fragment,E),E.forEach(_),this.h()},h(){var p,E;qe(o.src,i=(E=(p=l[0].author)==null?void 0:p.profile)==null?void 0:E.avatar_url)||b(o,"src",i),b(o,"alt","users banner"),b(o,"class","w-full h-full rounded-full object-cover"),b(s,"class","w-9 h-9"),b(c,"class","text-base font-semibold capitalize"),b(S,"class","text-sm font-medium text-gray-600"),b(a,"class","flex items-center gap-3"),b(r,"class","flex justify-between mb-2"),b(t,"class","p-3 pb-0"),b(ie,"class","flex items-center gap-4 px-3"),b(T,"class","flex items-center gap-4 px-3"),qe(Z.src,ne=l[1].avatar_url)||b(Z,"src",ne),b(Z,"alt","users banner"),b(Z,"class","w-full h-full rounded-full object-cover"),b(te,"class","w-7 h-7"),b(P,"type","text"),b(P,"placeholder","Add class comment"),b(P,"class","w-full bg-transparent border border-gray-200 dark:border-neutral-600 rounded-3xl"),P.required=!0,b(C,"class","flex-1"),b(Y,"class","flex items-center justify-between gap-2"),b(q,"class","border-t border-gray-200 dark:border-neutral-600 p-3"),b(e,"id",tt=l[0].id),b(e,"class",nt="flex flex-col gap-5 "+(l[3]?"border-2 border-primary-700":"border border-gray-200 dark:border-neutral-600")+" rounded-md mb-7 max-w-3xl")},m(p,E){O(p,e,E),m(e,n),m(n,t),m(t,r),m(r,a),m(a,s),m(s,o),m(a,u),m(a,f),m(f,c),m(c,h),m(f,F),m(f,S),m(S,X),m(r,K),R(N,r,null),m(t,ue),J&&J.m(t,null),m(n,ee),m(n,T),m(T,ie);for(let x=0;x<j.length;x+=1)j[x]&&j[x].m(ie,null);m(e,we),m(e,q),Q&&Q.m(q,null),m(q,_e),m(q,B);for(let x=0;x<U.length;x+=1)U[x]&&U[x].m(B,null);m(q,L),m(q,Y),m(Y,te),m(te,Z),m(Y,d),m(Y,C),m(C,P),$t(P,l[9]),m(Y,W),m(Y,G),R(re,G,null),m(q,et),le&&le.m(q,null),m(e,ge),R($e,e,null),be=!0,ot||(dt=[Ke(P,"input",l[28]),Ke(P,"keydown",l[14]),Ke(G,"click",l[14])],ot=!0)},p(p,E){var Le,He,We,je,Xe;(!be||E[0]&1&&!qe(o.src,i=(He=(Le=p[0].author)==null?void 0:Le.profile)==null?void 0:He.avatar_url))&&b(o,"src",i),(!be||E[0]&1)&&g!==(g=((je=(We=p[0].author)==null?void 0:We.profile)==null?void 0:je.fullname)+"")&&oe(h,g),(!be||E[0]&1)&&H!==(H=lt(p[0].created_at)+"")&&oe(X,H);const x={};if(E[0]&37|E[1]&32&&(x.$$scope={dirty:E,ctx:p}),N.$set(x),E[0]&1&&(ce=!It(p[0].content)),ce?J?(J.p(p,E),E[0]&1&&w(J,1)):(J=At(p),J.c(),w(J,1),J.m(t,null)):J&&(he(),v(J,1,1,()=>{J=null}),pe()),E[0]&140289){Te=Ge(Object.keys(p[0].reaction));let y;for(y=0;y<Te.length;y+=1){const Ne=Mt(p,Te,y);j[y]?(j[y].p(Ne,E),w(j[y],1)):(j[y]=zt(Ne),j[y].c(),w(j[y],1),j[y].m(ie,null))}for(he(),y=Te.length;y<j.length;y+=1)Wt(y);pe()}if(p[0].comment.length>0?Q?(Q.p(p,E),E[0]&1&&w(Q,1)):(Q=St(p),Q.c(),w(Q,1),Q.m(q,_e)):Q&&(he(),v(Q,1,1,()=>{Q=null}),pe()),E[0]&65937){Be=Ge(p[0].comment);let y;for(y=0;y<Be.length;y+=1){const Ne=Dt(p,Be,y);U[y]?(U[y].p(Ne,E),w(U[y],1)):(U[y]=Bt(Ne),U[y].c(),w(U[y],1),U[y].m(B,null))}for(he(),y=Be.length;y<U.length;y+=1)Xt(y);pe()}(!be||E[0]&2&&!qe(Z.src,ne=p[1].avatar_url))&&b(Z,"src",ne),E[0]&512&&P.value!==p[9]&&$t(P,p[9]),(Xe=p[6])!=null&&Xe.newComment?le?le.p(p,E):(le=Ot(p),le.c(),le.m(q,null)):le&&(le.d(1),le=null);const Oe={};!at&&E[0]&32&&(at=!0,Oe.openDeleteModal=p[5],Ve(()=>at=!1)),$e.$set(Oe),(!be||E[0]&1&&tt!==(tt=p[0].id))&&b(e,"id",tt),(!be||E[0]&8&&nt!==(nt="flex flex-col gap-5 "+(p[3]?"border-2 border-primary-700":"border border-gray-200 dark:border-neutral-600")+" rounded-md mb-7 max-w-3xl"))&&b(e,"class",nt)},i(p){if(!be){w(N.$$.fragment,p),w(J);for(let E=0;E<Te.length;E+=1)w(j[E]);w(Q);for(let E=0;E<Be.length;E+=1)w(U[E]);w(re.$$.fragment,p),w($e.$$.fragment,p),be=!0}},o(p){v(N.$$.fragment,p),v(J),j=j.filter(Boolean);for(let E=0;E<j.length;E+=1)v(j[E]);v(Q),U=U.filter(Boolean);for(let E=0;E<U.length;E+=1)v(U[E]);v(re.$$.fragment,p),v($e.$$.fragment,p),be=!1},d(p){p&&_(e),z(N),J&&J.d(),ft(j,p),Q&&Q.d(),ft(U,p),z(re),le&&le.d(),z($e),ot=!1,en(dt)}}}function Ln(l,e,n){let t,r,a;me(l,Pe,d=>n(30,t=d)),me(l,Yt,d=>n(7,r=d)),me(l,dn,d=>n(8,a=d));let{feed:s}=e,{editFeed:o}=e,{author:i}=e,{edit:u=!1}=e,{deleteFeed:f=d=>{}}=e,{deleteComment:c=d=>{}}=e,{addNewComment:g=(d,C,P)=>{}}=e,{addNewReaction:h=(d,C,P)=>{}}=e,{onPin:F=(d,C)=>{}}=e,{isActive:S=!1}=e,H="",X=!1,K=!1,N,ue={smile:"ðŸ˜€",thumbsup:"ðŸ‘",thumbsdown:"ðŸ‘Ž",clap:"ðŸ‘"};const ce=()=>{fe(Pe,t.open=!0,t),n(19,u=!0),u===!0&&n(18,o=s)},ee=()=>{n(4,X=!X)},T=d=>{h(d,s.id,i.id)},ie=d=>{if(d.key==="Enter"||d.type==="click"){if(n(6,N=gn(H)),Object.keys(N).length)return;d.preventDefault(),g(H,s.id,i.id),n(9,H="")}},we=()=>{f(s.id)},q=d=>{c(d)},_e=d=>(s.reaction[d]||[]).includes(i.id)?"bg-primary-200 border-primary-600 pl-2":"bg-gray-200 border-gray-600 pl-2";tn(()=>{if(S){const d=document.getElementById(s.id);d==null||d.scrollIntoView({block:"start",behavior:"smooth",inline:"nearest"})}});const B=()=>F(s.id,s.isPinned),L=()=>n(5,K=!0),Y=d=>T(d),te=d=>q(d.id);function Z(){H=this.value,n(9,H)}function ne(d){K=d,n(5,K)}return l.$$set=d=>{"feed"in d&&n(0,s=d.feed),"editFeed"in d&&n(18,o=d.editFeed),"author"in d&&n(1,i=d.author),"edit"in d&&n(19,u=d.edit),"deleteFeed"in d&&n(20,f=d.deleteFeed),"deleteComment"in d&&n(21,c=d.deleteComment),"addNewComment"in d&&n(22,g=d.addNewComment),"addNewReaction"in d&&n(23,h=d.addNewReaction),"onPin"in d&&n(2,F=d.onPin),"isActive"in d&&n(3,S=d.isActive)},[s,i,F,S,X,K,N,r,a,H,ue,ce,ee,T,ie,we,q,_e,o,u,f,c,g,h,B,L,Y,te,Z,ne]}class Hn extends ze{constructor(e){super(),Se(this,e,Ln,On,ye,{feed:0,editFeed:18,author:1,edit:19,deleteFeed:20,deleteComment:21,addNewComment:22,addNewReaction:23,onPin:2,isActive:3},null,[-1,-1])}}async function jn(l){return ke.from("course_newsfeed").select("reaction").eq("id",l).single()}async function Un(l){const e=await ke.from("course_newsfeed").select(`
    id,
    created_at,
    content,
    course_id,
    author:groupmember(
      profile(
        id,
        fullname,
        avatar_url
      )
    ),
    reaction,
    is_pinned,
    comment:course_newsfeed_comment(
        id,
        created_at,
        author:groupmember( profile(id, fullname, avatar_url) ),
        content,
        course_newsfeed_id)
    `).match({course_id:l}).order("created_at",{ascending:!1}).returns(),{data:n,error:t}=e;return{data:n,error:t}}async function qn(l){return{response:await ke.from("course_newsfeed").insert({content:l.content,author_id:l.author_id,course_id:l.course_id,reaction:l.reaction}).select()}}async function Yn(l,e){return await ke.from("course_newsfeed").update({content:e}).match({id:l}).select()}async function Gn(l){return{response:await ke.from("course_newsfeed_comment").insert({content:l.content,author_id:l.author_id,course_newsfeed_id:l.course_newsfeed_id}).select()}}async function Zn(l,e){return{response:await ke.from("course_newsfeed").update({is_pinned:e}).match({id:l})}}async function Jn(l){return await ke.from("course_newsfeed_comment").delete().match({id:l})}async function Qn(l){return await ke.from("course_newsfeed_comment").delete().match({course_newsfeed_id:l}),await ke.from("course_newsfeed").delete().match({id:l})}function Lt(l){let e,n=l[3].newPost+"",t;return{c(){e=$("p"),t=se(n),this.h()},l(r){e=I(r,"P",{class:!0});var a=k(e);t=ae(a,n),a.forEach(_),this.h()},h(){b(e,"class","text-sm text-red-500")},m(r,a){O(r,e,a),m(e,t)},p(r,a){a&8&&n!==(n=r[3].newPost+"")&&oe(t,n)},d(r){r&&_(e)}}}function Wn(l){let e,n,t,r,a,s,o,i,u,f;n=new pn({props:{value:l[1],onChange:l[13],placeholder:l[5]("course.navItem.news_feed.heading_button.placeholder"),maxHeight:400}});let c=l[3].newPost&&Lt(l);return o=new xe({props:{label:l[5]("course.navItem.news_feed.heading_button.cancel"),variant:ut.OUTLINED,onClick:l[7]}}),u=new xe({props:{isLoading:l[2],label:l[5]("course.navItem.news_feed.heading_button.post"),onClick:l[6]}}),{c(){e=$("section"),A(n.$$.fragment),t=D(),c&&c.c(),r=D(),a=$("div"),s=$("div"),A(o.$$.fragment),i=D(),A(u.$$.fragment),this.h()},l(g){e=I(g,"SECTION",{class:!0});var h=k(e);V(n.$$.fragment,h),t=M(h),c&&c.l(h),r=M(h),a=I(h,"DIV",{class:!0});var F=k(a);s=I(F,"DIV",{class:!0});var S=k(s);V(o.$$.fragment,S),i=M(S),V(u.$$.fragment,S),S.forEach(_),F.forEach(_),h.forEach(_),this.h()},h(){b(s,"class","flex gap-2"),b(a,"class","flex items-center justify-end py-2"),b(e,"class","flex flex-col rounded-xl pb-3 h-full w-2/")},m(g,h){O(g,e,h),R(n,e,null),m(e,t),c&&c.m(e,null),m(e,r),m(e,a),m(a,s),R(o,s,null),m(s,i),R(u,s,null),f=!0},p(g,h){const F={};h&2&&(F.value=g[1]),h&2&&(F.onChange=g[13]),h&32&&(F.placeholder=g[5]("course.navItem.news_feed.heading_button.placeholder")),n.$set(F),g[3].newPost?c?c.p(g,h):(c=Lt(g),c.c(),c.m(e,r)):c&&(c.d(1),c=null);const S={};h&32&&(S.label=g[5]("course.navItem.news_feed.heading_button.cancel")),o.$set(S);const H={};h&4&&(H.isLoading=g[2]),h&32&&(H.label=g[5]("course.navItem.news_feed.heading_button.post")),u.$set(H)},i(g){f||(w(n.$$.fragment,g),w(o.$$.fragment,g),w(u.$$.fragment,g),f=!0)},o(g){v(n.$$.fragment,g),v(o.$$.fragment,g),v(u.$$.fragment,g),f=!1},d(g){g&&_(e),z(n),c&&c.d(),z(o),z(u)}}}function Xn(l){let e,n,t;function r(s){l[14](s)}let a={onClose:l[7],width:"w-4/5",maxWidth:"max-w-lg",modalHeading:l[0]===!0?l[5]("course.navItem.news_feed.heading_button.edit_post"):l[5]("course.navItem.news_feed.heading_button.make_a_post"),$$slots:{default:[Wn]},$$scope:{ctx:l}};return l[4].open!==void 0&&(a.open=l[4].open),e=new Zt({props:a}),Ae.push(()=>De(e,"open",r)),{c(){A(e.$$.fragment)},l(s){V(e.$$.fragment,s)},m(s,o){R(e,s,o),t=!0},p(s,[o]){const i={};o&33&&(i.modalHeading=s[0]===!0?s[5]("course.navItem.news_feed.heading_button.edit_post"):s[5]("course.navItem.news_feed.heading_button.make_a_post")),o&65582&&(i.$$scope={dirty:o,ctx:s}),!n&&o&16&&(n=!0,i.open=s[4].open,Ve(()=>n=!1)),e.$set(i)},i(s){t||(w(e.$$.fragment,s),t=!0)},o(s){v(e.$$.fragment,s),t=!1},d(s){z(e,s)}}}function Kn(l,e,n){let t,r;me(l,Pe,N=>n(4,t=N)),me(l,Qt,N=>n(5,r=N));let{author:a={}}=e,{courseId:s=""}=e,{onSave:o=N=>{}}=e,{onEdit:i=(N,ue)=>{}}=e,{edit:u=!1}=e,{editFeed:f}=e,c="",g=!1,h,F={};const S=async()=>{if(n(3,F=hn(_n(c))),!Object.keys(F).length){n(2,g=!0);try{if(u)i(f.id,c),de.success("snackbar.newsfeed.success.edit"),n(0,u=!1),n(1,c=""),fe(Pe,t.open=!1,t);else{const{response:{data:N}}=await qn({content:c,author_id:a.id,course_id:s,reaction:{smile:[],thumbsup:[],thumbsdown:[],clap:[]}});if(!N||(h=N[0],!h))return;o({id:h.id,content:c,author:{profile:{...a}},created_at:h.created_at,comment:[],reaction:h.reaction,isPinned:!1}),de.success("snackbar.newsfeed.success.add"),H()}}catch{de.error("snackbar.newsfeed.error.error "+(u?"snackbar.newsfeed.error.editing":"snackbar.newsfeed.error.creating"))}finally{n(2,g=!1)}}},H=()=>{n(1,c=""),n(0,u=!1),fe(Pe,t.open=!1,t)},X=N=>{n(1,c=N)};function K(N){l.$$.not_equal(t.open,N)&&(t.open=N,Pe.set(t))}return l.$$set=N=>{"author"in N&&n(8,a=N.author),"courseId"in N&&n(9,s=N.courseId),"onSave"in N&&n(10,o=N.onSave),"onEdit"in N&&n(11,i=N.onEdit),"edit"in N&&n(0,u=N.edit),"editFeed"in N&&n(12,f=N.editFeed)},l.$$.update=()=>{l.$$.dirty&4097&&n(1,c=u===!0?f==null?void 0:f.content:"")},[u,c,g,F,t,r,S,H,a,s,o,i,f,X,K]}class xn extends ze{constructor(e){super(),Se(this,e,Kn,Xn,ye,{author:8,courseId:9,onSave:10,onEdit:11,edit:0,editFeed:12})}}function er(l){let e,n,t,r,a,s,o,i;return t=new bn({props:{style:"height: 2rem; width: 2rem;",class:"rounded-full overflow-hidden"}}),a=new Ft({props:{width:"30%"}}),o=new Ft({props:{paragraph:!0,lines:3}}),{c(){e=$("div"),n=$("div"),A(t.$$.fragment),r=D(),A(a.$$.fragment),s=D(),A(o.$$.fragment),this.h()},l(u){e=I(u,"DIV",{class:!0});var f=k(e);n=I(f,"DIV",{class:!0});var c=k(n);V(t.$$.fragment,c),r=M(c),V(a.$$.fragment,c),c.forEach(_),s=M(f),V(o.$$.fragment,f),f.forEach(_),this.h()},h(){b(n,"class","flex items-center gap-2"),b(e,"class","flex flex-col gap-5 border border-gray-300 p-4 rounded-md mb-7 max-w-3xl")},m(u,f){O(u,e,f),m(e,n),R(t,n,null),m(n,r),R(a,n,null),m(e,s),R(o,e,null),i=!0},p:Me,i(u){i||(w(t.$$.fragment,u),w(a.$$.fragment,u),w(o.$$.fragment,u),i=!0)},o(u){v(t.$$.fragment,u),v(a.$$.fragment,u),v(o.$$.fragment,u),i=!1},d(u){u&&_(e),z(t),z(a),z(o)}}}class it extends ze{constructor(e){super(),Se(this,e,null,er,ye,{})}}function Ht(l,e,n){const t=l.slice();return t[31]=e[n],t}function tr(l){let e,n;return e=new xe({props:{className:"mr-2",label:l[7]("course.navItem.news_feed.heading_button.title"),onClick:l[18]}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,r){R(e,t,r),n=!0},p(t,r){const a={};r[0]&128&&(a.label=t[7]("course.navItem.news_feed.heading_button.title")),r[0]&256&&(a.onClick=t[18]),e.$set(a)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function nr(l){let e,n,t;return n=new st({props:{allowedRoles:[1,2],$$slots:{default:[tr]},$$scope:{ctx:l}}}),{c(){e=$("slot:fragment"),A(n.$$.fragment),this.h()},l(r){e=I(r,"SLOT:FRAGMENT",{slot:!0});var a=k(e);V(n.$$.fragment,a),a.forEach(_),this.h()},h(){b(e,"slot","widget")},m(r,a){O(r,e,a),R(n,e,null),t=!0},p(r,a){const s={};a[0]&384|a[1]&8&&(s.$$scope={dirty:a,ctx:r}),n.$set(s)},i(r){t||(w(n.$$.fragment,r),t=!0)},o(r){v(n.$$.fragment,r),t=!1},d(r){r&&_(e),z(n)}}}function rr(l){let e,n,t,r;function a(i){l[20](i)}function s(i){l[21](i)}let o={courseId:l[0].courseId,author:l[5],onSave:l[19],onEdit:l[10]};return l[2]!==void 0&&(o.edit=l[2]),l[4]!==void 0&&(o.editFeed=l[4]),e=new xn({props:o}),Ae.push(()=>De(e,"edit",a)),Ae.push(()=>De(e,"editFeed",s)),{c(){A(e.$$.fragment)},l(i){V(e.$$.fragment,i)},m(i,u){R(e,i,u),r=!0},p(i,u){const f={};u[0]&1&&(f.courseId=i[0].courseId),u[0]&32&&(f.author=i[5]),u[0]&2&&(f.onSave=i[19]),!n&&u[0]&4&&(n=!0,f.edit=i[2],Ve(()=>n=!1)),!t&&u[0]&16&&(t=!0,f.editFeed=i[4],Ve(()=>t=!1)),e.$set(f)},i(i){r||(w(e.$$.fragment,i),r=!0)},o(i){v(e.$$.fragment,i),r=!1},d(i){z(e,i)}}}function lr(l){let e,n,t=Ge(l[1]),r=[];for(let s=0;s<t.length;s+=1)r[s]=Ut(Ht(l,t,s));const a=s=>v(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();e=Re()},l(s){for(let o=0;o<r.length;o+=1)r[o].l(s);e=Re()},m(s,o){for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(s,o);O(s,e,o),n=!0},p(s,o){if(o[0]&64182){t=Ge(s[1]);let i;for(i=0;i<t.length;i+=1){const u=Ht(s,t,i);r[i]?(r[i].p(u,o),w(r[i],1)):(r[i]=Ut(u),r[i].c(),w(r[i],1),r[i].m(e.parentNode,e))}for(he(),i=t.length;i<r.length;i+=1)a(i);pe()}},i(s){if(!n){for(let o=0;o<t.length;o+=1)w(r[o]);n=!0}},o(s){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)v(r[o]);n=!1},d(s){s&&_(e),ft(r,s)}}}function sr(l){let e,n;return e=new wn({props:{$$slots:{default:[or]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,r){R(e,t,r),n=!0},p(t,r){const a={};r[0]&128|r[1]&8&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function ar(l){let e,n,t,r,a,s,o;return n=new it({}),r=new it({}),s=new it({}),{c(){e=$("div"),A(n.$$.fragment),t=D(),A(r.$$.fragment),a=D(),A(s.$$.fragment)},l(i){e=I(i,"DIV",{});var u=k(e);V(n.$$.fragment,u),t=M(u),V(r.$$.fragment,u),a=M(u),V(s.$$.fragment,u),u.forEach(_)},m(i,u){O(i,e,u),R(n,e,null),m(e,t),R(r,e,null),m(e,a),R(s,e,null),o=!0},p:Me,i(i){o||(w(n.$$.fragment,i),w(r.$$.fragment,i),w(s.$$.fragment,i),o=!0)},o(i){v(n.$$.fragment,i),v(r.$$.fragment,i),v(s.$$.fragment,i),o=!1},d(i){i&&_(e),z(n),z(r),z(s)}}}function jt(l){let e,n,t,r,a=l[7]("course.navItem.news_feed.pinned")+"",s,o;return n=new In({props:{size:16}}),{c(){e=$("div"),A(n.$$.fragment),t=D(),r=$("p"),s=se(a),this.h()},l(i){e=I(i,"DIV",{class:!0});var u=k(e);V(n.$$.fragment,u),t=M(u),r=I(u,"P",{class:!0});var f=k(r);s=ae(f,a),f.forEach(_),u.forEach(_),this.h()},h(){b(r,"class","text-sm"),b(e,"class","flex items-center gap-2 mb-3")},m(i,u){O(i,e,u),R(n,e,null),m(e,t),m(e,r),m(r,s),o=!0},p(i,u){(!o||u[0]&128)&&a!==(a=i[7]("course.navItem.news_feed.pinned")+"")&&oe(s,a)},i(i){o||(w(n.$$.fragment,i),o=!0)},o(i){v(n.$$.fragment,i),o=!1},d(i){i&&_(e),z(n)}}}function Ut(l){let e,n,t,r,a,s=l[31].isPinned&&jt(l);function o(f){l[22](f)}function i(f){l[23](f)}let u={feed:l[31],deleteFeed:l[15],addNewComment:l[13],deleteComment:l[11],addNewReaction:l[12],onPin:l[14],author:l[5],isActive:l[9]===l[31].id};return l[2]!==void 0&&(u.edit=l[2]),l[4]!==void 0&&(u.editFeed=l[4]),n=new Hn({props:u}),Ae.push(()=>De(n,"edit",o)),Ae.push(()=>De(n,"editFeed",i)),{c(){s&&s.c(),e=D(),A(n.$$.fragment)},l(f){s&&s.l(f),e=M(f),V(n.$$.fragment,f)},m(f,c){s&&s.m(f,c),O(f,e,c),R(n,f,c),a=!0},p(f,c){f[31].isPinned?s?(s.p(f,c),c[0]&2&&w(s,1)):(s=jt(f),s.c(),w(s,1),s.m(e.parentNode,e)):s&&(he(),v(s,1,1,()=>{s=null}),pe());const g={};c[0]&2&&(g.feed=f[31]),c[0]&32&&(g.author=f[5]),c[0]&2&&(g.isActive=f[9]===f[31].id),!t&&c[0]&4&&(t=!0,g.edit=f[2],Ve(()=>t=!1)),!r&&c[0]&16&&(r=!0,g.editFeed=f[4],Ve(()=>r=!1)),n.$set(g)},i(f){a||(w(s),w(n.$$.fragment,f),a=!0)},o(f){v(s),v(n.$$.fragment,f),a=!1},d(f){f&&_(e),s&&s.d(f),z(n,f)}}}function or(l){let e,n,t,r,a,s=l[7]("course.navItem.news_feed.body_header")+"",o,i,u,f=l[7]("course.navItem.news_feed.body_content")+"",c;return{c(){e=$("div"),n=$("img"),r=D(),a=$("h2"),o=se(s),i=D(),u=$("p"),c=se(f),this.h()},l(g){e=I(g,"DIV",{class:!0});var h=k(e);n=I(h,"IMG",{src:!0,alt:!0,class:!0}),r=M(h),a=I(h,"H2",{class:!0});var F=k(a);o=ae(F,s),F.forEach(_),i=M(h),u=I(h,"P",{class:!0});var S=k(u);c=ae(S,f),S.forEach(_),h.forEach(_),this.h()},h(){qe(n.src,t="/images/empty-lesson-icon.svg")||b(n,"src",t),b(n,"alt","Lesson"),b(n,"class","my-2.5 mx-auto"),b(a,"class","text-xl my-1.5 font-normal"),b(u,"class","text-sm text-center text-slate-500"),b(e,"class","flex justify-between flex-col items-center w-[90%] md:w-96")},m(g,h){O(g,e,h),m(e,n),m(e,r),m(e,a),m(a,o),m(e,i),m(e,u),m(u,c)},p(g,h){h[0]&128&&s!==(s=g[7]("course.navItem.news_feed.body_header")+"")&&oe(o,s),h[0]&128&&f!==(f=g[7]("course.navItem.news_feed.body_content")+"")&&oe(c,f)},d(g){g&&_(e)}}}function ir(l){let e,n,t,r,a,s;e=new st({props:{allowedRoles:[1,2],$$slots:{default:[rr]},$$scope:{ctx:l}}});const o=[ar,sr,lr],i=[];function u(f,c){return f[3]?0:f[1].length?2:1}return t=u(l),r=i[t]=o[t](l),{c(){A(e.$$.fragment),n=D(),r.c(),a=Re()},l(f){V(e.$$.fragment,f),n=M(f),r.l(f),a=Re()},m(f,c){R(e,f,c),O(f,n,c),i[t].m(f,c),O(f,a,c),s=!0},p(f,c){const g={};c[0]&55|c[1]&8&&(g.$$scope={dirty:c,ctx:f}),e.$set(g);let h=t;t=u(f),t===h?i[t].p(f,c):(he(),v(i[h],1,1,()=>{i[h]=null}),pe(),r=i[t],r?r.p(f,c):(r=i[t]=o[t](f),r.c()),w(r,1),r.m(a.parentNode,a))},i(f){s||(w(e.$$.fragment,f),w(r),s=!0)},o(f){v(e.$$.fragment,f),v(r),s=!1},d(f){f&&(_(n),_(a)),z(e,f),i[t].d(f)}}}function fr(l){let e,n,t,r;return e=new sn({props:{title:l[7]("course.navItem.news_feed.heading"),disableSticky:!0,$$slots:{widget:[nr]},$$scope:{ctx:l}}}),t=new on({props:{width:"max-w-4xl px-3",$$slots:{default:[ir]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment),n=D(),A(t.$$.fragment)},l(a){V(e.$$.fragment,a),n=M(a),V(t.$$.fragment,a)},m(a,s){R(e,a,s),O(a,n,s),R(t,a,s),r=!0},p(a,s){const o={};s[0]&128&&(o.title=a[7]("course.navItem.news_feed.heading")),s[0]&384|s[1]&8&&(o.$$scope={dirty:s,ctx:a}),e.$set(o);const i={};s[0]&191|s[1]&8&&(i.$$scope={dirty:s,ctx:a}),t.$set(i)},i(a){r||(w(e.$$.fragment,a),w(t.$$.fragment,a),r=!0)},o(a){v(e.$$.fragment,a),v(t.$$.fragment,a),r=!1},d(a){a&&_(n),z(e,a),z(t,a)}}}function ur(l){let e,n;return e=new st({props:{allowedRoles:qt(l[6]),onDenied:l[24],$$slots:{default:[fr]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,r){R(e,t,r),n=!0},p(t,r){const a={};r[0]&64&&(a.allowedRoles=qt(t[6])),r[0]&1&&(a.onDenied=t[24]),r[0]&447|r[1]&8&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function cr(l){let e,n,t;function r(s){l[25](s)}let a={$$slots:{default:[ur]},$$scope:{ctx:l}};return l[0].courseId!==void 0&&(a.courseId=l[0].courseId),e=new an({props:a}),Ae.push(()=>De(e,"courseId",r)),{c(){A(e.$$.fragment)},l(s){V(e.$$.fragment,s)},m(s,o){R(e,s,o),t=!0},p(s,o){const i={};o[0]&511|o[1]&8&&(i.$$scope={dirty:o,ctx:s}),!n&&o[0]&1&&(n=!0,i.courseId=s[0].courseId,Ve(()=>n=!1)),e.$set(i)},i(s){t||(w(e.$$.fragment,s),t=!0)},o(s){v(e.$$.fragment,s),t=!1},d(s){z(e,s)}}}function qt(l){const e=[1,2];return l.customization.course.newsfeed&&e.push(3),e}function dr(l,e,n){let t,r,a,s,o,i,u;me(l,ve,d=>n(1,t=d)),me(l,Yt,d=>n(16,r=d)),me(l,fn,d=>n(17,a=d)),me(l,ln,d=>n(27,s=d)),me(l,mn,d=>n(6,o=d)),me(l,Qt,d=>n(7,i=d)),me(l,Pe,d=>n(8,u=d));let{data:f}=e,c,g=!1,h=!1,F,S={id:"",username:"",fullname:"",avatar_url:""},X=new URLSearchParams(s.url.search).get("feedId")||"";const K=(d,C)=>{Yn(d,C),fe(ve,t=t.map(P=>P.id===d?{...P,content:C}:P),t)},N=d=>(Jn(d),fe(ve,t=t.flatMap(C=>({...C,comment:C.comment.filter(P=>P.id!==d)})),t),de.success("snackbar.course.success.comment_deleted")),ue=async(d,C,P)=>{const{data:W}=await jn(C);if(!W)return;const G=W||t.find(ge=>ge.id===C);let re=G.reaction[d];if(re.includes(P)?re=re.filter(ge=>ge!==P):re=[...re,P],G.reaction={...G.reaction,[d]:re},(await ke.from("course_newsfeed").update({reaction:G.reaction}).eq("id",C)).error)return de.error("snackbar.course.error.reaction_error");fe(ve,t=t.map(ge=>(ge.id===C&&(ge.reaction=G.reaction),ge)),t)},ce=async(d,C,P)=>{const{response:W}=await Gn({content:d,author_id:P,course_newsfeed_id:C});if(W.error)return de.error("snackbar.course.error.commenting_error");W.data&&(c=W==null?void 0:W.data[0],fe(ve,t=t.map(G=>{if(G.id===C){const re={id:c.id,author:{profile:{...S}},created_at:c.created_at,content:d};return de.success("snackbar.course.success.comment_added"),{...G,comment:[...G.comment,{...re}]}}return G}),t))},ee=async(d,C)=>{const P=!C,{response:W}=await Zn(d,P);if(W.error)return de.error("snackbar.course.error.toggle_error");fe(ve,t=t.map(G=>(G.id===d&&(de.success(`${P?"snackbar.course.success.pinned":"snackbar.course.success.unpinned"} snackbar.course.success.successfully`),G.isPinned=P),G)),t)},T=d=>{Qn(d);const C=t.filter(P=>P.id!==d);de.success("snackbar.course.success.feed_delete_success"),fe(ve,t=C,t)},ie=async d=>{if(d)try{n(3,h=!0);const{data:C,error:P}=await Un(d);P&&de.error("snackbar.course.error.news_feed_fail"),C&&fe(ve,t=C.map(W=>({...W,isPinned:W.is_pinned})),t)}catch{de.error("snackbar.course.error.feed_fetch_error")}finally{n(3,h=!1)}};function we(d,C){const P=d.people.find(W=>W.profile_id===C);n(5,S={id:(P==null?void 0:P.id)||"",username:r.username||"",fullname:r.fullname||"",avatar_url:r.avatar_url||""})}const q=()=>fe(Pe,u.open=!0,u),_e=d=>{fe(ve,t=[d,...t],t)};function B(d){g=d,n(2,g)}function L(d){F=d,n(4,F)}function Y(d){g=d,n(2,g)}function te(d){F=d,n(4,F)}const Z=()=>{vn(`/courses/${f.courseId}/lessons?next=true`)};function ne(d){l.$$.not_equal(f.courseId,d)&&(f.courseId=d,n(0,f))}return l.$$set=d=>{"data"in d&&n(0,f=d.data)},l.$$.update=()=>{l.$$.dirty[0]&1&&ie(f.courseId),l.$$.dirty[0]&196608&&we(a,r.id),l.$$.dirty[0]&2&&fe(ve,t=t.sort((d,C)=>Number(C.isPinned)-Number(d.isPinned)),t)},[f,t,g,h,F,S,o,i,u,X,K,N,ue,ce,ee,T,r,a,q,_e,B,L,Y,te,Z,ne]}class Ur extends ze{constructor(e){super(),Se(this,e,dr,cr,ye,{data:0},null,[-1,-1])}}export{Ur as component,jr as universal};
//# sourceMappingURL=10.df566063.js.map
