import{s as ie,w as J,x as S,y as ae,d as h,z as C,i as E,A as Y,p as W,B as se,C as F,D as T,b as z,e as V,f as R,t as H,l as K,m as re}from"../chunks/scheduler.ee52cacd.js";import{S as ne,i as oe,f as G,b as j,d as M,m as O,t as b,a as $,e as q,g as Q,c as X}from"../chunks/index.a2391391.js";import{g as le}from"../chunks/navigation.4bf4851d.js";import{T as B}from"../chunks/TextField.05bb724d.js";import{P as fe}from"../chunks/index.550ce75a.js";import{a as ue}from"../chunks/supabase.2c784bff.js";import{g as me,a as de,b as pe}from"../chunks/validator.b0d7db8b.js";import{S as ce}from"../chunks/authentication.9d48b2e5.js";import{A as ge}from"../chunks/index.817dabbc.js";import{j as _e,h as Z}from"../chunks/org.1ee4885a.js";import{s as be}from"../chunks/theme.5ef85a9d.js";import{l as he}from"../chunks/logout.796ba466.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="7824a72c-718f-4268-87e7-52e0c22b7461",t._sentryDebugIdIdentifier="sentry-dbid-7824a72c-718f-4268-87e7-52e0c22b7461")}catch{}})();function we(t){let e;return{c(){e=H("Create a free account to join")},l(i){e=K(i,"Create a free account to join")},m(i,n){E(i,e,n)},d(i){i&&h(e)}}}function ve(t){let e;return{c(){e=H("Log in to join")},l(i){e=K(i,"Log in to join")},m(i,n){E(i,e,n)},d(i){i&&h(e)}}}function x(t){let e,i,n;function u(s){t[11](s)}let d={label:"Full Name",type:"text",autoFocus:!0,placeholder:"e.g Joke Silva",className:"mb-6",inputClassName:"w-full",isDisabled:t[2],errorMessage:t[3].name,isRequired:!0};return t[1].name!==void 0&&(d.value=t[1].name),e=new B({props:d}),J.push(()=>G(e,"value",u)),{c(){j(e.$$.fragment)},l(s){M(e.$$.fragment,s)},m(s,a){O(e,s,a),n=!0},p(s,a){const m={};a&4&&(m.isDisabled=s[2]),a&8&&(m.errorMessage=s[3].name),!i&&a&2&&(i=!0,m.value=s[1].name,Y(()=>i=!1)),e.$set(m)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){$(e.$$.fragment,s),n=!1},d(s){q(e,s)}}}function ee(t){let e,i,n;function u(s){t[13](s)}let d={label:"Confirm Password",type:"password",placeholder:"************",className:"mb-6",inputClassName:"w-full",isDisabled:t[2],errorMessage:t[3].confirmPassword,isRequired:!0};return t[1].confirmPassword!==void 0&&(d.value=t[1].confirmPassword),e=new B({props:d}),J.push(()=>G(e,"value",u)),{c(){j(e.$$.fragment)},l(s){M(e.$$.fragment,s)},m(s,a){O(e,s,a),n=!0},p(s,a){const m={};a&4&&(m.isDisabled=s[2]),a&8&&(m.errorMessage=s[3].confirmPassword),!i&&a&2&&(i=!0,m.value=s[1].confirmPassword,Y(()=>i=!1)),e.$set(m)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){$(e.$$.fragment,s),n=!1},d(s){q(e,s)}}}function te(t){let e,i;return{c(){e=F("p"),i=H(t[4]),this.h()},l(n){e=T(n,"P",{class:!0});var u=z(e);i=K(u,t[4]),u.forEach(h),this.h()},h(){V(e,"class","text-sm text-red-500")},m(n,u){E(n,e,u),R(e,i)},p(n,u){u&16&&re(i,n[4])},d(n){n&&h(e)}}}function $e(t){let e,i,n,u,d,s,a,m,g,y,I,_,v,N;function A(r,l){return r[0].invite.profile?ve:we}let L=A(t),w=L(t);u=new B({props:{label:"Your Email",value:t[0].invite.email,type:"email",placeholder:"you@domain.com",className:"mb-6",inputClassName:"w-full",isDisabled:!0}});let p=!t[0].invite.profile&&x(t);function f(r){t[12](r)}let U={label:"Your Password",type:"password",placeholder:"************",className:"mb-6",inputClassName:"w-full",isDisabled:t[2],errorMessage:t[3].password,helperMessage:"Password must be more than 6 characters",isRequired:!0};t[1].password!==void 0&&(U.value=t[1].password),a=new B({props:U}),J.push(()=>G(a,"value",f));let o=!t[0].invite.profile&&ee(t),c=t[4]&&te(t);return v=new fe({props:{label:"Accept Invite",type:"submit",className:"sm:w-full w-full",isDisabled:t[5]||t[2],isLoading:t[2]}}),{c(){e=F("div"),i=F("p"),w.c(),n=S(),j(u.$$.fragment),d=S(),p&&p.c(),s=S(),j(a.$$.fragment),g=S(),o&&o.c(),y=S(),c&&c.c(),I=S(),_=F("div"),j(v.$$.fragment),this.h()},l(r){e=T(r,"DIV",{class:!0});var l=z(e);i=T(l,"P",{class:!0});var D=z(i);w.l(D),D.forEach(h),n=C(l),M(u.$$.fragment,l),d=C(l),p&&p.l(l),s=C(l),M(a.$$.fragment,l),g=C(l),o&&o.l(l),y=C(l),c&&c.l(l),l.forEach(h),I=C(r),_=T(r,"DIV",{class:!0});var P=z(_);M(v.$$.fragment,P),P.forEach(h),this.h()},h(){V(i,"class","dark:text-white text-lg font-semibold mb-6"),V(e,"class","mt-4 w-full"),V(_,"class","my-4 w-full flex justify-end items-center")},m(r,l){E(r,e,l),R(e,i),w.m(i,null),R(e,n),O(u,e,null),R(e,d),p&&p.m(e,null),R(e,s),O(a,e,null),R(e,g),o&&o.m(e,null),R(e,y),c&&c.m(e,null),E(r,I,l),E(r,_,l),O(v,_,null),N=!0},p(r,l){L!==(L=A(r))&&(w.d(1),w=L(r),w&&(w.c(),w.m(i,null)));const D={};l&1&&(D.value=r[0].invite.email),u.$set(D),r[0].invite.profile?p&&(Q(),$(p,1,1,()=>{p=null}),X()):p?(p.p(r,l),l&1&&b(p,1)):(p=x(r),p.c(),b(p,1),p.m(e,s));const P={};l&4&&(P.isDisabled=r[2]),l&8&&(P.errorMessage=r[3].password),!m&&l&2&&(m=!0,P.value=r[1].password,Y(()=>m=!1)),a.$set(P),r[0].invite.profile?o&&(Q(),$(o,1,1,()=>{o=null}),X()):o?(o.p(r,l),l&1&&b(o,1)):(o=ee(r),o.c(),b(o,1),o.m(e,y)),r[4]?c?c.p(r,l):(c=te(r),c.c(),c.m(e,null)):c&&(c.d(1),c=null);const k={};l&36&&(k.isDisabled=r[5]||r[2]),l&4&&(k.isLoading=r[2]),v.$set(k)},i(r){N||(b(u.$$.fragment,r),b(p),b(a.$$.fragment,r),b(o),b(v.$$.fragment,r),N=!0)},o(r){$(u.$$.fragment,r),$(p),$(a.$$.fragment,r),$(o),$(v.$$.fragment,r),N=!1},d(r){r&&(h(e),h(I),h(_)),w.d(),q(u),p&&p.d(),q(a),o&&o.d(),c&&c.d(),q(v)}}}function Pe(t){let e,i,n,u;function d(a){t[14](a)}let s={supabase:t[7],isLogin:!1,handleSubmit:t[8],isLoading:t[2],showLogo:!0,$$slots:{default:[$e]},$$scope:{ctx:t}};return t[6]!==void 0&&(s.formRef=t[6]),i=new ge({props:s}),J.push(()=>G(i,"formRef",d)),{c(){e=S(),j(i.$$.fragment),this.h()},l(a){ae("svelte-lxd68k",document.head).forEach(h),e=C(a),M(i.$$.fragment,a),this.h()},h(){document.title="Join KinetsHub"},m(a,m){E(a,e,m),O(i,a,m),u=!0},p(a,[m]){const g={};m&4&&(g.isLoading=a[2]),m&65599&&(g.$$scope={dirty:m,ctx:a}),!n&&m&64&&(n=!0,g.formRef=a[6],Y(()=>n=!1)),i.$set(g)},i(a){u||(b(i.$$.fragment,a),u=!0)},o(a){$(i.$$.fragment,a),u=!1},d(a){a&&h(e),q(i,a)}}}function ye(t,e,i){let n,u;W(t,_e,f=>i(9,n=f)),W(t,Z,f=>i(10,u=f));let{data:d}=e,s=ue(),a=Object.assign({},ce),m=!1,g={},y,I=!1,_;async function v(){var U;const f=pe({...a,email:"test@gmail.com"});if(console.log("validationRes",f),Object.keys(f).length){i(3,g=Object.assign(g,f));return}try{i(2,m=!0);let o=d.invite.profile;if(!d.invite.profile){const{data:l,error:D}=await s.auth.signUp({email:d.invite.email,password:a.password});if(console.log("Signup",l),D)throw D;if(!l.user)throw"User cannot be created ";const P=l.user.id,k=await s.from("profile").insert({id:P,username:a.name.toLowerCase().replace(" ","-")+new Date().getTime(),fullname:a.name,email:d.invite.email}).select();if(console.log("Insert profile",k.data),k.error)throw k.error;o=k.data[0]||{}}if(!(o!=null&&o.id))throw"Unable to create profile";const c=await s.auth.signInWithPassword({email:o.email,password:a.password});if(c.error)throw c.error;const r=await s.from("organizationmember").update({verified:!0,profile_id:o.id}).match({email:o.email,organization_id:(U=d.invite.currentOrg)==null?void 0:U.id});return console.log("Update member response",r),_==null||_.reset(),le(n)}catch(o){o instanceof Error?i(4,y=o.message):i(4,y=(o==null?void 0:o.toString())||"")}finally{i(2,m=!1)}}function N(f){f&&(console.log(f),Z.set(f))}se(async()=>{var f;await he(!1),be(((f=d.invite.currentOrg)==null?void 0:f.theme)||""),N(d.invite.currentOrg)});function A(f){t.$$.not_equal(a.name,f)&&(a.name=f,i(1,a))}function L(f){t.$$.not_equal(a.password,f)&&(a.password=f,i(1,a))}function w(f){t.$$.not_equal(a.confirmPassword,f)&&(a.confirmPassword=f,i(1,a))}function p(f){_=f,i(6,_)}return t.$$set=f=>{"data"in f&&i(0,d=f.data)},t.$$.update=()=>{t.$$.dirty&2&&i(3,g.confirmPassword=me(a),g),t.$$.dirty&2&&i(5,I=de(a)),t.$$.dirty&1&&console.log("data",d.invite),t.$$.dirty&1024&&console.log("org",u),t.$$.dirty&512&&console.log("path",n)},[d,a,m,g,y,I,_,s,v,n,u,A,L,w,p]}class qe extends ne{constructor(e){super(),oe(this,e,ye,Pe,ie,{data:0})}}export{qe as component};
//# sourceMappingURL=23.aa24a176.js.map
