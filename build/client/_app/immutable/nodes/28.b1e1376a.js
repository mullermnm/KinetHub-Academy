import{s as ae,C as E,t as q,x as T,D,b as y,l as S,d as h,z as R,e as g,i as z,f as u,m as A,Q as oe,p as G}from"../chunks/scheduler.ee52cacd.js";import{S as ne,i as ce,t as H,c as ue,a as J,b as fe,d as de,m as me,e as he,g as pe}from"../chunks/index.a2391391.js";import{e as M}from"../chunks/each.4f9c2159.js";import{c as ee}from"../chunks/cloneDeep.a1cf627e.js";import{C as _e}from"../chunks/index.5d9eba69.js";import{p as ge}from"../chunks/user.9ccdc884.js";import{h as be}from"../chunks/org.1ee4885a.js";import{s as ve}from"../chunks/store.21c1b842.js";import{s as xe}from"../chunks/supabase.2c784bff.js";import{c as we}from"../chunks/date.4043184d.js";import{t as ke}from"../chunks/translations.f943b7b3.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[t]="e35f48fb-a62a-466e-bbb9-b8e92ed11753",o._sentryDebugIdIdentifier="sentry-dbid-e35f48fb-a62a-466e-bbb9-b8e92ed11753")}catch{}})();async function Ee(o,t){const{data:s,error:l}=await xe.from("exercise").select(`
      id,
      title,
      updated_at,
      questions:question(points),
      submission (
        status_id,
        updated_at,
        total,
        groupmember:submitted_by!inner (
          id,
          profile:profile_id!inner (
            id
          )
        )
      ),
      lesson!inner (
        id,
        title,
        order,
        is_unlocked,
        course!inner (
          id,
          title,
          group:group_id!inner (
            organisation:organization_id!inner (
              id
            ),
            groupmember!inner(
              id,
              profile:profile_id!inner (
                id
              )
            )
          )
        )
      )
    `).eq("lesson.is_unlocked",!0).eq("lesson.course.group.organisation.id",t).eq("lesson.course.group.groupmember.profile.id",o).eq("submission.groupmember.profile.id",o);return{exercises:s,error:l}}function te(o,t,s){const l=o.slice();return l[7]=t[s].title,l[8]=t[s].items,l[9]=t[s].className,l[10]=t[s].id,l}function se(o,t,s){const l=o.slice();return l[13]=t[s],l}function re(o){let t,s=o[13].grade+"",l,d;return{c(){t=q("("),l=q(s),d=q(") -")},l(n){t=S(n,"("),l=S(n,s),d=S(n,") -")},m(n,b){z(n,t,b),z(n,l,b),z(n,d,b)},p(n,b){b&1&&s!==(s=n[13].grade+"")&&A(l,s)},d(n){n&&(h(t),h(l),h(d))}}}function le(o){let t,s,l,d=o[13].courseTitle+"",n,b,w,p,v,m=o[13].exerciseTitle+"",_,i,f,e,a,r=o[1]("exercises.lesson")+"",c,$,k,L=o[13].lessonTitle+"",N,C,F,V,P=o[13].submissionUpdatedAt+"",O,Q,U=o[10]===3&&re(o);return{c(){t=E("div"),s=E("a"),l=E("p"),n=q(d),w=T(),p=E("a"),U&&U.c(),v=T(),_=q(m),f=T(),e=E("a"),a=E("p"),c=q(r),$=T(),k=E("span"),N=q(L),F=T(),V=E("p"),O=q(P),Q=T(),this.h()},l(I){t=D(I,"DIV",{class:!0});var x=y(t);s=D(x,"A",{class:!0,href:!0});var K=y(s);l=D(K,"P",{class:!0});var W=y(l);n=S(W,d),W.forEach(h),K.forEach(h),w=R(x),p=D(x,"A",{class:!0,href:!0});var j=y(p);U&&U.l(j),v=R(j),_=S(j,m),j.forEach(h),f=R(x),e=D(x,"A",{class:!0,href:!0});var X=y(e);a=D(X,"P",{class:!0});var B=y(a);c=S(B,r),$=R(B),k=D(B,"SPAN",{class:!0});var Y=y(k);N=S(Y,L),Y.forEach(h),B.forEach(h),X.forEach(h),F=R(x),V=D(x,"P",{class:!0});var Z=y(V);O=S(Z,P),Z.forEach(h),Q=R(x),x.forEach(h),this.h()},h(){g(l,"class","text-xs"),g(s,"class","flex w-full items-center cursor-pointer text-primary-600 mb-2"),g(s,"href",b=o[13].courseURL),g(p,"class","text-black dark:text-white text-md font-bold"),g(p,"href",i=o[13].exerciseURL),g(k,"class","italic"),g(a,"class","dark:text-white text-grey text-sm"),g(e,"class","flex items-center no-underline hover:underline text-black my-2 w-fit"),g(e,"href",C=o[13].lessonURL),g(V,"class","dark:text-white text-gray-500 text-xs"),g(t,"class","w-full my-2 mx-0 rounded-md bg-white dark:bg-neutral-800 py-3 px-3")},m(I,x){z(I,t,x),u(t,s),u(s,l),u(l,n),u(t,w),u(t,p),U&&U.m(p,null),u(p,v),u(p,_),u(t,f),u(t,e),u(e,a),u(a,c),u(a,$),u(a,k),u(k,N),u(t,F),u(t,V),u(V,O),u(t,Q)},p(I,x){x&1&&d!==(d=I[13].courseTitle+"")&&A(n,d),x&1&&b!==(b=I[13].courseURL)&&g(s,"href",b),I[10]===3?U?U.p(I,x):(U=re(I),U.c(),U.m(p,v)):U&&(U.d(1),U=null),x&1&&m!==(m=I[13].exerciseTitle+"")&&A(_,m),x&1&&i!==(i=I[13].exerciseURL)&&g(p,"href",i),x&2&&r!==(r=I[1]("exercises.lesson")+"")&&A(c,r),x&1&&L!==(L=I[13].lessonTitle+"")&&A(N,L),x&1&&C!==(C=I[13].lessonURL)&&g(e,"href",C),x&1&&P!==(P=I[13].submissionUpdatedAt+"")&&A(O,P)},d(I){I&&h(t),U&&U.d()}}}function ie(o){let t,s,l,d=o[7]+"",n,b,w,p,v,m,_;w=new _e({props:{value:o[8].length,className:o[9]}});let i=M(o[8]),f=[];for(let e=0;e<i.length;e+=1)f[e]=le(se(o,i,e));return{c(){t=E("div"),s=E("div"),l=E("p"),n=q(d),b=T(),fe(w.$$.fragment),p=T(),v=E("div");for(let e=0;e<f.length;e+=1)f[e].c();m=T(),this.h()},l(e){t=D(e,"DIV",{class:!0});var a=y(t);s=D(a,"DIV",{class:!0});var r=y(s);l=D(r,"P",{class:!0});var c=y(l);n=S(c,d),c.forEach(h),b=R(r),de(w.$$.fragment,r),r.forEach(h),p=R(a),v=D(a,"DIV",{class:!0});var $=y(v);for(let k=0;k<f.length;k+=1)f[k].l($);$.forEach(h),m=R(a),a.forEach(h),this.h()},h(){g(l,"class","dark:text-white ml-2 font-bold"),g(s,"class","flex items-center mb-2 gap-2"),g(v,"class","pr-2 h-full overflow-y-auto pb-3"),g(t,"class","min-w-[355px] max-w-[355px] h-[70vh] rounded-md bg-gray-100 dark:bg-black border border-gray-50 dark:border-neutral-700 p-3 mr-3 overflow-hidden")},m(e,a){z(e,t,a),u(t,s),u(s,l),u(l,n),u(s,b),me(w,s,null),u(t,p),u(t,v);for(let r=0;r<f.length;r+=1)f[r]&&f[r].m(v,null);u(t,m),_=!0},p(e,a){(!_||a&1)&&d!==(d=e[7]+"")&&A(n,d);const r={};if(a&1&&(r.value=e[8].length),a&1&&(r.className=e[9]),w.$set(r),a&3){i=M(e[8]);let c;for(c=0;c<i.length;c+=1){const $=se(e,i,c);f[c]?f[c].p($,a):(f[c]=le($),f[c].c(),f[c].m(v,null))}for(;c<f.length;c+=1)f[c].d(1);f.length=i.length}},i(e){_||(H(w.$$.fragment,e),_=!0)},o(e){J(w.$$.fragment,e),_=!1},d(e){e&&h(t),he(w),oe(f,e)}}}function De(o){let t,s,l,d,n=o[1]("exercises.heading")+"",b,w,p,v,m,_=M(o[0]),i=[];for(let e=0;e<_.length;e+=1)i[e]=ie(te(o,_,e));const f=e=>J(i[e],1,1,()=>{i[e]=null});return{c(){t=E("section"),s=E("div"),l=E("div"),d=E("h1"),b=q(n),w=T(),p=E("div"),v=E("div");for(let e=0;e<i.length;e+=1)i[e].c();this.h()},l(e){t=D(e,"SECTION",{class:!0});var a=y(t);s=D(a,"DIV",{class:!0});var r=y(s);l=D(r,"DIV",{class:!0});var c=y(l);d=D(c,"H1",{class:!0});var $=y(d);b=S($,n),$.forEach(h),c.forEach(h),w=R(r),p=D(r,"DIV",{});var k=y(p);v=D(k,"DIV",{class:!0});var L=y(v);for(let N=0;N<i.length;N+=1)i[N].l(L);L.forEach(h),k.forEach(h),r.forEach(h),a.forEach(h),this.h()},h(){g(d,"class","dark:text-white text-3xl font-bold"),g(l,"class","flex items-center justify-between mb-10"),g(v,"class","flex items-center w-full"),g(s,"class","p-5"),g(t,"class","w-full max-w-6xl mx-auto")},m(e,a){z(e,t,a),u(t,s),u(s,l),u(l,d),u(d,b),u(s,w),u(s,p),u(p,v);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(v,null);m=!0},p(e,[a]){if((!m||a&2)&&n!==(n=e[1]("exercises.heading")+"")&&A(b,n),a&3){_=M(e[0]);let r;for(r=0;r<_.length;r+=1){const c=te(e,_,r);i[r]?(i[r].p(c,a),H(i[r],1)):(i[r]=ie(c),i[r].c(),H(i[r],1),i[r].m(v,null))}for(pe(),r=_.length;r<i.length;r+=1)f(r);ue()}},i(e){if(!m){for(let a=0;a<_.length;a+=1)H(i[a]);m=!0}},o(e){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)J(i[a]);m=!1},d(e){e&&h(t),oe(i,e)}}}function ye(o,t,s){let l,d,n;G(o,be,m=>s(2,l=m)),G(o,ge,m=>s(3,d=m)),G(o,ke,m=>s(1,n=m));const b=[{id:0,title:n("exercises.not_submitted"),items:[],className:"text-[#E35353] bg-[#FDDFE4]"},{id:1,title:n("exercises.submitted"),items:[],className:"text-orange-700 bg-orange-200"},{id:2,title:n("exercises.in_progress"),items:[],className:"text-yellow-700 bg-yellow-200"},{id:3,title:n("exercises.graded"),value:0,items:[],className:"text-green-700 bg-green-200"}];let w=ee(b);function p(m){const _=ee(b);for(const i of m){const{id:f,title:e,updated_at:a,submission:r,lesson:c,questions:$}=i,k=r[0]||{status_id:0,updated_at:a,total:0},L=`/courses/${c.course.id}`,N=`${L}/lessons/${c.id}`,C=`${N}/exercises/${f}`,F=`${k.total}/${$.reduce((P,O)=>P+=O.points,0)}`,V={exerciseId:f,courseTitle:c.course.title,courseURL:L,exerciseTitle:e,exerciseURL:C,lessonTitle:c.title,lessonNo:c.order<9?"0"+(c.order+1):`${c.order}`,lessonURL:N,submissionStatus:k.status_id,submissionUpdatedAt:we(k.updated_at),grade:F};_[k.status_id].items.push(V)}return _}async function v(m,_){const{exercises:i,error:f}=await Ee(m,_);if(console.log("exercises",i),console.log("error",f),f){ve.error("snackbar.exercise.error_fetching");return}i&&(s(0,w=p(i)),console.log("sections",w))}return o.$$.update=()=>{o.$$.dirty&12&&d.id&&l.id&&v(d.id,l.id)},[w,n,l,d]}class Pe extends ne{constructor(t){super(),ce(this,t,ye,De,ae,{})}}export{Pe as component};
//# sourceMappingURL=28.b1e1376a.js.map
