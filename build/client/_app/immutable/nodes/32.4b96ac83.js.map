{"version":3,"file":"32.4b96ac83.js","sources":["../../../../../../src/routes/login/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { page } from '$app/stores';\n  import TextField from '$lib/components/Form/TextField.svelte';\n  import PrimaryButton from '$lib/components/PrimaryButton/index.svelte';\n  import { getSupabase } from '$lib/utils/functions/supabase';\n  import { authValidation } from '$lib/utils/functions/validator';\n  import { LOGIN_FIELDS } from '$lib/utils/constants/authentication';\n  import AuthUI from '$lib/components/AuthUI/index.svelte';\n  import { currentOrg } from '$lib/utils/store/org';\n  import { capturePosthogEvent } from '$lib/utils/services/posthog';\n  import { t } from '$lib/utils/functions/translations';\n  import { globalStore } from '$lib/utils/store/app';\n\n  let formRef: HTMLFormElement;\n  let supabase = getSupabase();\n  let fields = Object.assign({}, LOGIN_FIELDS);\n  let submitError: string;\n  let loading = false;\n  let errors = Object.assign({}, LOGIN_FIELDS);\n\n  let query = new URLSearchParams($page.url.search);\n  let redirect = query.get('redirect');\n\n  async function handleSubmit() {\n    const validationRes = authValidation(fields);\n    console.log('validationRes', validationRes);\n\n    if (Object.keys(validationRes).length) {\n      errors = Object.assign(errors, validationRes);\n      return;\n    }\n\n    try {\n      loading = true;\n      const { data, error } = await supabase.auth.signInWithPassword({\n        email: fields.email,\n        password: fields.password\n      });\n      console.log('data', data);\n      if (error) throw error;\n\n      capturePosthogEvent('login', {\n        email: fields.email\n      });\n\n      if ($globalStore.isOrgSite) {\n        capturePosthogEvent('student_login', {\n          email: fields.email\n        });\n      }\n    } catch (error) {\n      submitError = error.error_description || error.message;\n      loading = false;\n    }\n  }\n</script>\n\n<svelte:head>\n  <title>Welcome back to {$currentOrg.name || 'KinetsHub'}</title>\n</svelte:head>\n\n<AuthUI {supabase} isLogin={true} {handleSubmit} isLoading={loading} bind:formRef>\n  <div class=\"mt-4 w-full\">\n    <p class=\"dark:text-white text-lg font-semibold mb-6\">{$t('login.welcome')}</p>\n    <TextField\n      label={$t('login.email')}\n      bind:value={fields.email}\n      type=\"email\"\n      autoFocus={true}\n      placeholder=\"you@domain.com\"\n      className=\"mb-6\"\n      inputClassName=\"w-full\"\n      isDisabled={loading}\n      errorMessage={errors.email}\n    />\n    <TextField\n      label={$t('login.password')}\n      bind:value={fields.password}\n      type=\"password\"\n      placeholder=\"************\"\n      className=\"mb-6\"\n      inputClassName=\"w-full\"\n      isDisabled={loading}\n      errorMessage={errors.password}\n    />\n    {#if submitError}\n      <p class=\"text-sm text-red-500\">{submitError}</p>\n    {/if}\n    <div class=\"w-full text-right\">\n      <a class=\"text-md text-primary-700\" href=\"/forgot\"> {$t('login.forgot')} </a>\n    </div>\n  </div>\n\n  <div class=\"my-4 w-full flex justify-end items-center\">\n    <!-- <a href=\"/login\" class=\"text-primary-700 text-sm\">Create an account</a> -->\n    <PrimaryButton\n      label={$t('login.login')}\n      type=\"submit\"\n      className=\"sm:w-full w-full\"\n      isDisabled={loading}\n      isLoading={loading}\n    />\n  </div>\n</AuthUI>\n"],"names":["t0_value","ctx","t5_value","textfield0_props","textfield1_props","current","dirty","set_data","t0","textfield0_changes","textfield1_changes","t5","primarybutton_changes","formRef","submitError","handleSubmit","validationRes","authValidation","fields","error","$$self","value"],"mappings":"83CA+D2DA,EAAAC,EAAA,CAAA,EAAA,eAAA,EAAA,yBA0BAC,EAAAD,EAAA,CAAA,EAAA,cAAA,EAAA,2CAxB9C,MAAAA,EAAA,CAAA,EAAA,aAAA,kHAQO,aAAAA,EAAA,CAAA,EAAA,OAPFA,EAAA,CAAA,EAAA,QAAA,SAAAE,EAAA,MAAAF,EAAA,CAAA,EAAA,qFAUL,MAAAA,EAAA,CAAA,EAAA,gBAAA,sGAOO,aAAAA,EAAA,CAAA,EAAA,UANFA,EAAA,CAAA,EAAA,WAAA,SAAAG,EAAA,MAAAH,EAAA,CAAA,EAAA,mGAmBL,MAAAA,EAAA,CAAA,EAAA,aAAA,wgCAjC8C,CAAAI,GAAAC,EAAA,KAAAN,KAAAA,EAAAC,EAAA,CAAA,EAAA,eAAA,EAAA,KAAAM,EAAAC,EAAAR,CAAA,aAE9CM,EAAA,KAAAG,EAAA,MAAAR,EAAA,CAAA,EAAA,aAAA,4BAQOK,EAAA,KAAAG,EAAA,aAAAR,EAAA,CAAA,EAAA,sBAPFQ,EAAA,MAAAR,EAAA,CAAA,EAAA,wCAULK,EAAA,KAAAI,EAAA,MAAAT,EAAA,CAAA,EAAA,gBAAA,4BAOOK,EAAA,KAAAI,EAAA,aAAAT,EAAA,CAAA,EAAA,yBANFS,EAAA,MAAAT,EAAA,CAAA,EAAA,6FAYyC,CAAAI,GAAAC,EAAA,KAAAJ,KAAAA,EAAAD,EAAA,CAAA,EAAA,cAAA,EAAA,KAAAM,EAAAI,EAAAT,CAAA,aAO9CI,EAAA,KAAAM,EAAA,MAAAX,EAAA,CAAA,EAAA,aAAA,6lCAnFP,IAAAY,+BAGAC,+EAOW,eAAAC,GAAA,CACP,MAAAC,EAAAC,GAAAC,CAAA,iKAWF,MAAAA,EAAA,MACA,SAAAA,EAAA,0HAcK,OAAAC,EAAA,gEAgBKC,EAAA,GAAA,UAAAF,EAAA,MAAAG,CAAA,IAAAH,EAAA,MAAAG,wBAWAD,EAAA,GAAA,UAAAF,EAAA,SAAAG,CAAA,IAAAH,EAAA,SAAAG"}