{"version":3,"file":"_page.svelte-65549655.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/org/_slug_/community/ask/_page.svelte.js"],"sourcesContent":[";\n!function() {\n  try {\n    var e = \"undefined\" != typeof window ? window : \"undefined\" != typeof global ? global : \"undefined\" != typeof self ? self : {}, n = new Error().stack;\n    n && (e._sentryDebugIds = e._sentryDebugIds || {}, e._sentryDebugIds[n] = \"d073016b-1b20-44b0-a0d7-0c5161e6295f\", e._sentryDebugIdIdentifier = \"sentry-dbid-d073016b-1b20-44b0-a0d7-0c5161e6295f\");\n  } catch (e2) {\n  }\n}();\nimport { s as subscribe } from \"../../../../../../chunks/utils.js\";\nimport { c as create_ssr_component, a as add_attribute, v as validate_component, e as escape } from \"../../../../../../chunks/ssr.js\";\nimport { g as goto } from \"../../../../../../chunks/navigation.js\";\nimport { A as ArrowLeft } from \"../../../../../../chunks/ArrowLeft.js\";\nimport { a as currentOrg, c as currentOrgPath } from \"../../../../../../chunks/org.js\";\nimport { V as VARIANTS, P as PrimaryButton } from \"../../../../../../chunks/index11.js\";\nimport { d as askCommunityValidation } from \"../../../../../../chunks/validator.js\";\nimport { s as supabase } from \"../../../../../../chunks/supabase.js\";\nimport { b as snackbar } from \"../../../../../../chunks/store2.js\";\nimport { g as generateSlug } from \"../../../../../../chunks/generateSlug.js\";\nimport { T as TextEditor } from \"../../../../../../chunks/index26.js\";\nimport { T as TextField } from \"../../../../../../chunks/TextField.js\";\nimport { p as profile } from \"../../../../../../chunks/user.js\";\nimport { t as fetchCourses } from \"../../../../../../chunks/index18.js\";\nimport { t } from \"../../../../../../chunks/translations.js\";\nimport { a as courses } from \"../../../../../../chunks/store5.js\";\nimport { D as Dropdown } from \"../../../../../../chunks/Dropdown.js\";\nconst Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let $currentOrg, $$unsubscribe_currentOrg;\n  let $profile, $$unsubscribe_profile;\n  let $currentOrgPath, $$unsubscribe_currentOrgPath;\n  let $courses, $$unsubscribe_courses;\n  let $t, $$unsubscribe_t;\n  $$unsubscribe_currentOrg = subscribe(currentOrg, (value) => $currentOrg = value);\n  $$unsubscribe_profile = subscribe(profile, (value) => $profile = value);\n  $$unsubscribe_currentOrgPath = subscribe(currentOrgPath, (value) => $currentOrgPath = value);\n  $$unsubscribe_courses = subscribe(courses, (value) => $courses = value);\n  $$unsubscribe_t = subscribe(t, (value) => $t = value);\n  let errors = {};\n  let fields = { title: \"\", body: \"\", courseId: \"\" };\n  let fetchedCourses = [];\n  async function getCourses(userId, orgId) {\n    if ($courses.length) {\n      fetchedCourses = [...$courses];\n      return;\n    }\n    const coursesResults = await fetchCourses(userId, orgId);\n    if (!coursesResults)\n      return;\n    fetchedCourses = coursesResults.allCourses;\n  }\n  async function handleSave() {\n    errors = askCommunityValidation(fields);\n    console.log(\"handleSave errors\", errors);\n    if (Object.keys(errors).length) {\n      return;\n    }\n    const { data: question, error } = await supabase.from(\"community_question\").insert({\n      title: fields.title,\n      body: fields.body,\n      organization_id: $currentOrg.id,\n      author_profile_id: $profile.id,\n      votes: 0,\n      slug: generateSlug(fields.title),\n      course_id: fields.courseId\n    }).select();\n    if (error) {\n      console.error(\"Error: asking question\", error);\n      snackbar.error(\"snackbar.community.error.try_again\");\n    } else {\n      const slug = question[0]?.slug;\n      console.log(\"Success: asking question\", question, slug);\n      snackbar.success(\"snackbar.community.success.question_submitted\");\n      goto(`${$currentOrgPath}/community/${slug}`);\n    }\n  }\n  let $$settled;\n  let $$rendered;\n  do {\n    $$settled = true;\n    {\n      {\n        if ($profile.id && $currentOrg.id) {\n          getCourses($profile.id, $currentOrg.id);\n        }\n      }\n    }\n    $$rendered = `${$$result.head += `<!-- HEAD_svelte-igiws2_START -->${$$result.title = `<title>Ask the Community - KinetsHub</title>`, \"\"}<!-- HEAD_svelte-igiws2_END -->`, \"\"} <section class=\"w-full md:max-w-3xl md:mx-auto\"><div class=\"p-5\"><a class=\"text-gray-500 dark:text-white text-md flex items-center\"${add_attribute(\"href\", `${$currentOrgPath}/community`, 0)}>${validate_component(ArrowLeft, \"ArrowLeftIcon\").$$render(\n      $$result,\n      {\n        size: 24,\n        class: \"carbon-icon dark:text-white\"\n      },\n      {},\n      {}\n    )} ${escape($t(\"community.ask.go_back\"))}</a> <div class=\"flex items-center gap-12 justify-between\"><h1 class=\"dark:text-white text-2xl md:text-3xl font-bold\">${escape($t(\"community.ask.ask_the\"))}</h1> ${validate_component(PrimaryButton, \"PrimaryButton\").$$render(\n      $$result,\n      {\n        label: $t(\"community.ask.publish\"),\n        variant: VARIANTS.CONTAINED_DARK,\n        onClick: handleSave\n      },\n      {},\n      {}\n    )}</div></div> <div class=\"mb-3 p-2 flex gap-x-5 justify-between\">${validate_component(TextField, \"TextField\").$$render(\n      $$result,\n      {\n        placeholder: $t(\"community.ask.title\"),\n        errorMessage: errors.title,\n        className: \"w-[75%]\",\n        value: fields.title\n      },\n      {\n        value: ($$value) => {\n          fields.title = $$value;\n          $$settled = false;\n        }\n      },\n      {}\n    )} ${validate_component(Dropdown, \"Dropdown\").$$render(\n      $$result,\n      {\n        class: \"w-[25%] h-full\",\n        size: \"xl\",\n        label: $t(\"community.ask.select_course\"),\n        invalid: !!errors.courseId,\n        invalidText: errors.courseId,\n        items: fetchedCourses.map((course) => ({ id: course.id, text: course.title })),\n        selectedId: fields.courseId\n      },\n      {\n        selectedId: ($$value) => {\n          fields.courseId = $$value;\n          $$settled = false;\n        }\n      },\n      {}\n    )}</div> <div class=\"px-2\">${validate_component(TextEditor, \"TextEditor\").$$render(\n      $$result,\n      {\n        placeholder: $t(\"community.ask.ask_community\"),\n        onChange: (html) => fields.body = html,\n        value: fields.body\n      },\n      {\n        value: ($$value) => {\n          fields.body = $$value;\n          $$settled = false;\n        }\n      },\n      {}\n    )}</div></section>`;\n  } while (!$$settled);\n  $$unsubscribe_currentOrg();\n  $$unsubscribe_profile();\n  $$unsubscribe_currentOrgPath();\n  $$unsubscribe_courses();\n  $$unsubscribe_t();\n  return $$rendered;\n});\nexport {\n  Page as default\n};\n//# sourceMappingURL=_page.svelte.js.map\n"],"names":["t","Dropdown"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,CAAC,WAAW;AACZ,EAAE,IAAI;AACN,IAAI,IAAI,CAAC,GAAG,WAAW,IAAI,OAAO,MAAM,GAAG,MAAM,GAAG,WAAW,IAAI,OAAO,MAAM,GAAG,MAAM,GAAG,WAAW,IAAI,OAAO,IAAI,GAAG,IAAI,GAAG,EAAE,EAAE,CAAC,GAAG,IAAI,KAAK,EAAE,CAAC,KAAK,CAAC;AAC1J,IAAI,CAAC,KAAK,CAAC,CAAC,eAAe,GAAG,CAAC,CAAC,eAAe,IAAI,EAAE,EAAE,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,GAAG,sCAAsC,EAAE,CAAC,CAAC,wBAAwB,GAAG,kDAAkD,CAAC,CAAC;AACvM,GAAG,CAAC,OAAO,EAAE,EAAE;AACf,GAAG;AACH,CAAC,EAAE,CAAC;AAkBC,MAAC,IAAI,GAAG,oBAAoB,CAAC,CAAC,QAAQ,EAAE,OAAO,EAAE,UAAU,EAAE,KAAK,KAAK;AAC5E,EAAE,IAAI,WAAW,EAAE,wBAAwB,CAAC;AAC5C,EAAE,IAAI,QAAQ,EAAE,qBAAqB,CAAC;AACtC,EAAE,IAAI,eAAe,EAAE,4BAA4B,CAAC;AACpD,EAAE,IAAI,QAAQ,EAAE,qBAAqB,CAAC;AACtC,EAAE,IAAI,EAAE,EAAE,eAAe,CAAC;AAC1B,EAAE,wBAAwB,GAAG,SAAS,CAAC,UAAU,EAAE,CAAC,KAAK,KAAK,WAAW,GAAG,KAAK,CAAC,CAAC;AACnF,EAAE,qBAAqB,GAAG,SAAS,CAAC,OAAO,EAAE,CAAC,KAAK,KAAK,QAAQ,GAAG,KAAK,CAAC,CAAC;AAC1E,EAAE,4BAA4B,GAAG,SAAS,CAAC,cAAc,EAAE,CAAC,KAAK,KAAK,eAAe,GAAG,KAAK,CAAC,CAAC;AAC/F,EAAE,qBAAqB,GAAG,SAAS,CAAC,OAAO,EAAE,CAAC,KAAK,KAAK,QAAQ,GAAG,KAAK,CAAC,CAAC;AAC1E,EAAE,eAAe,GAAG,SAAS,CAACA,EAAC,EAAE,CAAC,KAAK,KAAK,EAAE,GAAG,KAAK,CAAC,CAAC;AACxD,EAAE,IAAI,MAAM,GAAG,EAAE,CAAC;AAClB,EAAE,IAAI,MAAM,GAAG,EAAE,KAAK,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,CAAC;AACrD,EAAE,IAAI,cAAc,GAAG,EAAE,CAAC;AAC1B,EAAE,eAAe,UAAU,CAAC,MAAM,EAAE,KAAK,EAAE;AAC3C,IAAI,IAAI,QAAQ,CAAC,MAAM,EAAE;AACzB,MAAM,cAAc,GAAG,CAAC,GAAG,QAAQ,CAAC,CAAC;AACrC,MAAM,OAAO;AACb,KAAK;AACL,IAAI,MAAM,cAAc,GAAG,MAAM,YAAY,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;AAC7D,IAAI,IAAI,CAAC,cAAc;AACvB,MAAM,OAAO;AACb,IAAI,cAAc,GAAG,cAAc,CAAC,UAAU,CAAC;AAC/C,GAAG;AACH,EAAE,eAAe,UAAU,GAAG;AAC9B,IAAI,MAAM,GAAG,sBAAsB,CAAC,MAAM,CAAC,CAAC;AAC5C,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB,EAAE,MAAM,CAAC,CAAC;AAC7C,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE;AACpC,MAAM,OAAO;AACb,KAAK;AACL,IAAI,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,MAAM,QAAQ,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC,MAAM,CAAC;AACvF,MAAM,KAAK,EAAE,MAAM,CAAC,KAAK;AACzB,MAAM,IAAI,EAAE,MAAM,CAAC,IAAI;AACvB,MAAM,eAAe,EAAE,WAAW,CAAC,EAAE;AACrC,MAAM,iBAAiB,EAAE,QAAQ,CAAC,EAAE;AACpC,MAAM,KAAK,EAAE,CAAC;AACd,MAAM,IAAI,EAAE,YAAY,CAAC,MAAM,CAAC,KAAK,CAAC;AACtC,MAAM,SAAS,EAAE,MAAM,CAAC,QAAQ;AAChC,KAAK,CAAC,CAAC,MAAM,EAAE,CAAC;AAChB,IAAI,IAAI,KAAK,EAAE;AACf,MAAM,OAAO,CAAC,KAAK,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;AACrD,MAAM,QAAQ,CAAC,KAAK,CAAC,oCAAoC,CAAC,CAAC;AAC3D,KAAK,MAAM;AACX,MAAM,MAAM,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;AACrC,MAAM,OAAO,CAAC,GAAG,CAAC,0BAA0B,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;AAC9D,MAAM,QAAQ,CAAC,OAAO,CAAC,+CAA+C,CAAC,CAAC;AACxE,MAAM,IAAI,CAAC,CAAC,EAAE,eAAe,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;AACnD,KAAK;AACL,GAAG;AACH,EAAE,IAAI,SAAS,CAAC;AAChB,EAAE,IAAI,UAAU,CAAC;AACjB,EAAE,GAAG;AACL,IAAI,SAAS,GAAG,IAAI,CAAC;AACrB,IAAI;AACJ,MAAM;AACN,QAAQ,IAAI,QAAQ,CAAC,EAAE,IAAI,WAAW,CAAC,EAAE,EAAE;AAC3C,UAAU,UAAU,CAAC,QAAQ,CAAC,EAAE,EAAE,WAAW,CAAC,EAAE,CAAC,CAAC;AAClD,SAAS;AACT,OAAO;AACP,KAAK;AACL,IAAI,UAAU,GAAG,CAAC,EAAE,QAAQ,CAAC,IAAI,IAAI,CAAC,iCAAiC,EAAE,QAAQ,CAAC,KAAK,GAAG,CAAC,4CAA4C,CAAC,EAAE,EAAE,CAAC,+BAA+B,CAAC,EAAE,EAAE,CAAC,oIAAoI,EAAE,aAAa,CAAC,MAAM,EAAE,CAAC,EAAE,eAAe,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,kBAAkB,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC,QAAQ;AAC3a,MAAM,QAAQ;AACd,MAAM;AACN,QAAQ,IAAI,EAAE,EAAE;AAChB,QAAQ,KAAK,EAAE,6BAA6B;AAC5C,OAAO;AACP,MAAM,EAAE;AACR,MAAM,EAAE;AACR,KAAK,CAAC,CAAC,EAAE,MAAM,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAAC,CAAC,sHAAsH,EAAE,MAAM,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAAC,CAAC,MAAM,EAAE,kBAAkB,CAAC,aAAa,EAAE,eAAe,CAAC,CAAC,QAAQ;AAC5Q,MAAM,QAAQ;AACd,MAAM;AACN,QAAQ,KAAK,EAAE,EAAE,CAAC,uBAAuB,CAAC;AAC1C,QAAQ,OAAO,EAAE,QAAQ,CAAC,cAAc;AACxC,QAAQ,OAAO,EAAE,UAAU;AAC3B,OAAO;AACP,MAAM,EAAE;AACR,MAAM,EAAE;AACR,KAAK,CAAC,gEAAgE,EAAE,kBAAkB,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC,QAAQ;AAC3H,MAAM,QAAQ;AACd,MAAM;AACN,QAAQ,WAAW,EAAE,EAAE,CAAC,qBAAqB,CAAC;AAC9C,QAAQ,YAAY,EAAE,MAAM,CAAC,KAAK;AAClC,QAAQ,SAAS,EAAE,SAAS;AAC5B,QAAQ,KAAK,EAAE,MAAM,CAAC,KAAK;AAC3B,OAAO;AACP,MAAM;AACN,QAAQ,KAAK,EAAE,CAAC,OAAO,KAAK;AAC5B,UAAU,MAAM,CAAC,KAAK,GAAG,OAAO,CAAC;AACjC,UAAU,SAAS,GAAG,KAAK,CAAC;AAC5B,SAAS;AACT,OAAO;AACP,MAAM,EAAE;AACR,KAAK,CAAC,CAAC,EAAE,kBAAkB,CAACC,UAAQ,EAAE,UAAU,CAAC,CAAC,QAAQ;AAC1D,MAAM,QAAQ;AACd,MAAM;AACN,QAAQ,KAAK,EAAE,gBAAgB;AAC/B,QAAQ,IAAI,EAAE,IAAI;AAClB,QAAQ,KAAK,EAAE,EAAE,CAAC,6BAA6B,CAAC;AAChD,QAAQ,OAAO,EAAE,CAAC,CAAC,MAAM,CAAC,QAAQ;AAClC,QAAQ,WAAW,EAAE,MAAM,CAAC,QAAQ;AACpC,QAAQ,KAAK,EAAE,cAAc,CAAC,GAAG,CAAC,CAAC,MAAM,MAAM,EAAE,EAAE,EAAE,MAAM,CAAC,EAAE,EAAE,IAAI,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC;AACtF,QAAQ,UAAU,EAAE,MAAM,CAAC,QAAQ;AACnC,OAAO;AACP,MAAM;AACN,QAAQ,UAAU,EAAE,CAAC,OAAO,KAAK;AACjC,UAAU,MAAM,CAAC,QAAQ,GAAG,OAAO,CAAC;AACpC,UAAU,SAAS,GAAG,KAAK,CAAC;AAC5B,SAAS;AACT,OAAO;AACP,MAAM,EAAE;AACR,KAAK,CAAC,yBAAyB,EAAE,kBAAkB,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC,QAAQ;AACtF,MAAM,QAAQ;AACd,MAAM;AACN,QAAQ,WAAW,EAAE,EAAE,CAAC,6BAA6B,CAAC;AACtD,QAAQ,QAAQ,EAAE,CAAC,IAAI,KAAK,MAAM,CAAC,IAAI,GAAG,IAAI;AAC9C,QAAQ,KAAK,EAAE,MAAM,CAAC,IAAI;AAC1B,OAAO;AACP,MAAM;AACN,QAAQ,KAAK,EAAE,CAAC,OAAO,KAAK;AAC5B,UAAU,MAAM,CAAC,IAAI,GAAG,OAAO,CAAC;AAChC,UAAU,SAAS,GAAG,KAAK,CAAC;AAC5B,SAAS;AACT,OAAO;AACP,MAAM,EAAE;AACR,KAAK,CAAC,gBAAgB,CAAC,CAAC;AACxB,GAAG,QAAQ,CAAC,SAAS,EAAE;AACvB,EAAE,wBAAwB,EAAE,CAAC;AAC7B,EAAE,qBAAqB,EAAE,CAAC;AAC1B,EAAE,4BAA4B,EAAE,CAAC;AACjC,EAAE,qBAAqB,EAAE,CAAC;AAC1B,EAAE,eAAe,EAAE,CAAC;AACpB,EAAE,OAAO,UAAU,CAAC;AACpB,CAAC;;;;"}