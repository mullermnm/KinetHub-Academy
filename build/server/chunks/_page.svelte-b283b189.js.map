{"version":3,"file":"_page.svelte-b283b189.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/invite/s/_hash_/_page.svelte.js"],"sourcesContent":[";\n!function() {\n  try {\n    var e = \"undefined\" != typeof window ? window : \"undefined\" != typeof global ? global : \"undefined\" != typeof self ? self : {}, n = new Error().stack;\n    n && (e._sentryDebugIds = e._sentryDebugIds || {}, e._sentryDebugIds[n] = \"7e6407eb-1b36-4148-a19e-ad5aa2f0b207\", e._sentryDebugIdIdentifier = \"sentry-dbid-7e6407eb-1b36-4148-a19e-ad5aa2f0b207\");\n  } catch (e2) {\n  }\n}();\nimport { s as subscribe } from \"../../../../../chunks/utils.js\";\nimport { c as create_ssr_component, e as escape, v as validate_component } from \"../../../../../chunks/ssr.js\";\nimport { g as goto } from \"../../../../../chunks/navigation.js\";\nimport { P as PrimaryButton } from \"../../../../../chunks/index11.js\";\nimport { g as getSupabase } from \"../../../../../chunks/supabase.js\";\nimport { A as AuthUI } from \"../../../../../chunks/index29.js\";\nimport { R as ROLE, a as currentOrg } from \"../../../../../chunks/org.js\";\nimport \"../../../../../chunks/_sentry-release-injection-file.js\";\nimport { s as addGroupMember } from \"../../../../../chunks/index18.js\";\nimport { p as profile } from \"../../../../../chunks/user.js\";\nimport { b as snackbar } from \"../../../../../chunks/store2.js\";\nimport { c as capturePosthogEvent } from \"../../../../../chunks/index23.js\";\nimport { p as page } from \"../../../../../chunks/stores.js\";\nconst Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let $profile, $$unsubscribe_profile;\n  let $page, $$unsubscribe_page;\n  $$unsubscribe_profile = subscribe(profile, (value) => $profile = value);\n  $$unsubscribe_page = subscribe(page, (value) => $page = value);\n  let { data } = $$props;\n  let supabase = getSupabase();\n  let loading = false;\n  let formRef;\n  async function handleSubmit() {\n    loading = true;\n    if (!$profile.id || !$profile.email) {\n      console.log(\"Profile not found\", $profile);\n      return goto(`/signup?redirect=${$page.url?.pathname || \"\"}`);\n    }\n    const { data: courseData, error } = await supabase.from(\"course\").select(\"group_id\").eq(\"id\", data.id).single();\n    console.log({ courseData });\n    if (!courseData?.group_id) {\n      console.error(\"error getting group\", error);\n      return;\n    }\n    const member = {\n      profile_id: $profile.id,\n      group_id: courseData.group_id,\n      role_id: ROLE.STUDENT\n    };\n    const teacherMembers = await supabase.from(\"groupmember\").select(\"id, profile(email)\").eq(\"group_id\", courseData.group_id).eq(\"role_id\", ROLE.TUTOR).returns();\n    teacherMembers.data?.map((teacher) => {\n      return teacher.profile?.email || \"\";\n    }) || [];\n    addGroupMember(member).then((addedMember) => {\n      loading = false;\n      if (addedMember.error) {\n        console.error(\"Error adding student to group\", courseData.group_id, addedMember.error);\n        snackbar.error(\"snackbar.invite.failed_join\");\n        window.location.href = \"/lms\";\n        return;\n      }\n      capturePosthogEvent(\"student_joined_course\", {\n        course_name: data.name,\n        student_id: $profile.id,\n        student_email: $profile.email\n      });\n      return goto(\"/lms\");\n    });\n  }\n  function setCurOrg(cOrg) {\n    if (!cOrg)\n      return;\n    currentOrg.set(cOrg);\n  }\n  if ($$props.data === void 0 && $$bindings.data && data !== void 0)\n    $$bindings.data(data);\n  let $$settled;\n  let $$rendered;\n  do {\n    $$settled = true;\n    {\n      setCurOrg(data.currentOrg);\n    }\n    $$rendered = `${$$result.head += `<!-- HEAD_svelte-1ucdzck_START -->${$$result.title = `<title>Join ${escape(data.name)} on KinetsHub</title>`, \"\"}<!-- HEAD_svelte-1ucdzck_END -->`, \"\"} ${validate_component(AuthUI, \"AuthUI\").$$render(\n      $$result,\n      {\n        supabase,\n        isLogin: false,\n        handleSubmit,\n        isLoading: loading,\n        showOnlyContent: true,\n        showLogo: true,\n        formRef\n      },\n      {\n        formRef: ($$value) => {\n          formRef = $$value;\n          $$settled = false;\n        }\n      },\n      {\n        default: () => {\n          return `<div class=\"mt-0 w-full\"><h3 class=\"dark:text-white text-lg font-medium mt-0 mb-4 text-center\">${escape(data.name)}</h3> <p class=\"dark:text-white text-sm font-light text-center\">${escape(data.description)}</p></div> <div class=\"my-4 w-full flex justify-center items-center\">${validate_component(PrimaryButton, \"PrimaryButton\").$$render(\n            $$result,\n            {\n              label: \"Join Course\",\n              type: \"submit\",\n              isDisabled: loading,\n              isLoading: loading\n            },\n            {},\n            {}\n          )}</div>`;\n        }\n      }\n    )}`;\n  } while (!$$settled);\n  $$unsubscribe_profile();\n  $$unsubscribe_page();\n  return $$rendered;\n});\nexport {\n  Page as default\n};\n//# sourceMappingURL=_page.svelte.js.map\n"],"names":[],"mappings":"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"}