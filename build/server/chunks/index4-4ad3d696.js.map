{"version":3,"file":"index4-4ad3d696.js","sources":["../../../.svelte-kit/adapter-node/chunks/index4.js"],"sourcesContent":[";\n!function() {\n  try {\n    var e = \"undefined\" != typeof window ? window : \"undefined\" != typeof global ? global : \"undefined\" != typeof self ? self : {}, n = new Error().stack;\n    n && (e._sentryDebugIds = e._sentryDebugIds || {}, e._sentryDebugIds[n] = \"52167427-7c6f-4f2d-a15c-00aadaa9f94c\", e._sentryDebugIdIdentifier = \"sentry-dbid-52167427-7c6f-4f2d-a15c-00aadaa9f94c\");\n  } catch (e2) {\n  }\n}();\nimport { s as supabase } from \"./supabase.js\";\nimport \"./_sentry-release-injection-file.js\";\nasync function fetchNewsFeedReaction(feedId) {\n  return supabase.from(\"course_newsfeed\").select(`reaction`).eq(\"id\", feedId).single();\n}\nasync function fetchNewsFeeds(courseId) {\n  const response = await supabase.from(\"course_newsfeed\").select(\n    `\n    id,\n    created_at,\n    content,\n    course_id,\n    author:groupmember(\n      profile(\n        id,\n        fullname,\n        avatar_url\n      )\n    ),\n    reaction,\n    is_pinned,\n    comment:course_newsfeed_comment(\n        id,\n        created_at,\n        author:groupmember( profile(id, fullname, avatar_url) ),\n        content,\n        course_newsfeed_id)\n    `\n  ).match({ course_id: courseId }).order(\"created_at\", { ascending: false }).returns();\n  const { data, error } = response;\n  return { data, error };\n}\nasync function createNewFeed(post) {\n  const response = await supabase.from(\"course_newsfeed\").insert({\n    content: post.content,\n    author_id: post.author_id,\n    course_id: post.course_id,\n    reaction: post.reaction\n  }).select();\n  return { response };\n}\nasync function handleEditFeed(feedId, content) {\n  const response = await supabase.from(\"course_newsfeed\").update({ content }).match({ id: feedId }).select();\n  return response;\n}\nasync function createComment(comment) {\n  const response = await supabase.from(\"course_newsfeed_comment\").insert({\n    content: comment.content,\n    author_id: comment.author_id,\n    course_newsfeed_id: comment.course_newsfeed_id\n  }).select();\n  return { response };\n}\nasync function toggleFeedIsPinned(feedId, isPinned) {\n  const response = await supabase.from(\"course_newsfeed\").update({\n    is_pinned: isPinned\n  }).match({ id: feedId });\n  return { response };\n}\nasync function deleteNewsFeedComment(commentId) {\n  const response = await supabase.from(\"course_newsfeed_comment\").delete().match({ id: commentId });\n  return response;\n}\nasync function deleteNewsFeed(feedId) {\n  await supabase.from(\"course_newsfeed_comment\").delete().match({ course_newsfeed_id: feedId });\n  const response = await supabase.from(\"course_newsfeed\").delete().match({ id: feedId });\n  return response;\n}\nasync function getFeedForNotification(params) {\n  const { data, error } = await params.supabase.from(\"course_newsfeed\").select(\n    `\n    content,\n    author:groupmember(profile(fullname, email)),\n    course(\n      id,\n      title,\n      group(\n        organization(siteName, name),\n        members:groupmember(id, profile(email, fullname))\n      )\n    )\n  `\n  ).eq(\"id\", params.feedId).limit(1).returns();\n  if (error) {\n    console.error(\"Failed to get feed\", error);\n    return null;\n  }\n  console.log({\n    data\n  });\n  const [feed] = data || [];\n  if (!feed)\n    return;\n  return {\n    id: params.feedId,\n    courseId: feed.course.id,\n    courseTitle: feed.course.title,\n    teacherName: feed.author?.profile?.fullname,\n    teacherEmail: feed.author?.profile?.email,\n    content: feed.content,\n    org: feed.course.group?.organization,\n    courseMembers: feed.course?.group?.members?.filter((member) => member.id !== params.authorId)?.map((member) => {\n      return member.profile;\n    })\n  };\n}\nexport {\n  fetchNewsFeedReaction as a,\n  createComment as b,\n  createNewFeed as c,\n  deleteNewsFeedComment as d,\n  deleteNewsFeed as e,\n  fetchNewsFeeds as f,\n  getFeedForNotification as g,\n  handleEditFeed as h,\n  toggleFeedIsPinned as t\n};\n//# sourceMappingURL=index4.js.map\n"],"names":[],"mappings":"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"}